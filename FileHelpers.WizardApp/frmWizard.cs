using System;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.IO;
using ColorCode;
using FileHelpers.Dynamic;
using System.Xml.Serialization;
using System.Diagnostics;
using FileHelpers.Detection;

namespace FileHelpers.WizardApp
{
    /// <summary>
    /// This is the main wizard form that allows you to
    /// create and modify a layout of record.
    /// </summary>
    public class frmWizard : System.Windows.Forms.Form
    {
        #region "  Autogenerated  "

        private Panel panStep1;
        private Label label1;
        private Panel panStep3;
        private Label label2;
        private GroupBox groupBox2;
        private NumericUpDown txtNumberOfFields;
        private Label label6;
        private PictureBox picFirstDark;
        private Panel panel1;
        private PictureBox picCurrStep;
        private Label lblStep0;
        private Label lblStep1;
        private PictureBox pictureBox1;
        private PictureBox pictureBox3;
        private FlowLayoutPanel panFields;
        private Label label9;
        private ComboBox txtDefaultType;
        private Label label10;
        private ComboBox cboFieldVisibility;
        private Panel panStep0;
        private GroupBox groupBox5;
        private TextBox txtClassName;
        private GroupBox groupBox8;
        private TextBox txtDelimiter;
        private RadioButton radDelimited;
        private RadioButton radFixed;
        private Label label18;
        private RadioButton radDelVertBar;
        private RadioButton radDelComma;
        private RadioButton radDelSemiCol;
        private RadioButton radDelCustom;
        private RadioButton radDelTabs;
        private GroupBox gbxDelimitedBy;
        private Panel panStep2;
        private Button cmdAddField;
        private Label label15;
        private ComboBox cboTemplate;
        private Button cmdSaveToFile;
        private Button cmdToClipboard;
        private Label label3;
        private ComboBox cboLanguage;
        private Label label4;
        private SaveFileDialog dlgSaveToFile;
        private PictureBox pictureBox5;
        private Label lblStep2;
        private Label lblStep3;
        private Button cmdReset;
        private Button cmdNext;
        private Button cmdBack;
        private Button cmdPreview;
        private Panel panel2;
        private Panel panPreview;
        private Button cmdSaveClass;
        private Button cmdCopyClass;
        private Label label5;
        private PictureBox pictureBox4;
        private ComboBox cboClassLanguage;
        private Label label7;
        private Button cmdSave;
        private SaveFileDialog dlgSaveWizard;
        private Button cmdLoad;
        private GroupBox groupBox1;
        private NumericUpDown txtIgnoreLast;
        private Label label14;
        private Label label16;
        private NumericUpDown txtIgnoreFirst;
        private Label label17;
        private Label label20;
        private GroupBox groupBox3;
        private IContainer components;
        private ToolTip toolTip1;
        private CheckBox chkProperties;
        private CheckBox chkIgnoreEmpty;
        private Button cmdTestClass;
        private NumericUpDown txtFieldLength;
        private Label label11;
        private PictureBox picDonate;
        private Label linkHome;
        private PictureBox picNewVersion;
        private PictureBox picCurrent;
        private Label label12;
        private ComboBox cboFixedMode2;
        private TextBox txtCommentMarker;
        private Label label13;
        private GroupBox groupBox4;
        private CheckBox chkCommentAnyPlace;
        private CheckBox chkSealed;
        private ComboBox cboClassVisibility;
        private Label label8;
        private Label label21;
        private TextBox txtRecordConditionSelector;
        private ComboBox cboRecordCondition;
        private Label label19;
        private CheckBox chkAllTrim;
        private CheckBox chkAllOptional;
        private CheckBox chkAllQuoted;
        private Button cmdDetectFormat;
        private Button cmdfileDesigner;
        private Button cmdDetectFormatWithHeader;
        private WebBrowser browserCode;
        private WebBrowser browserTemplate;
        private Panel panel3;
        private Panel panel4;
        private OpenFileDialog dlgOpenWizard;

        public frmWizard()
        {
            //
            // Required for Windows Form Designer support
            //
            InitializeComponent();
        }

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code
        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(frmWizard));
            this.panStep1 = new System.Windows.Forms.Panel();
            this.groupBox4 = new System.Windows.Forms.GroupBox();
            this.chkCommentAnyPlace = new System.Windows.Forms.CheckBox();
            this.label13 = new System.Windows.Forms.Label();
            this.txtCommentMarker = new System.Windows.Forms.TextBox();
            this.groupBox3 = new System.Windows.Forms.GroupBox();
            this.label21 = new System.Windows.Forms.Label();
            this.txtRecordConditionSelector = new System.Windows.Forms.TextBox();
            this.cboRecordCondition = new System.Windows.Forms.ComboBox();
            this.label19 = new System.Windows.Forms.Label();
            this.groupBox1 = new System.Windows.Forms.GroupBox();
            this.chkIgnoreEmpty = new System.Windows.Forms.CheckBox();
            this.txtIgnoreLast = new System.Windows.Forms.NumericUpDown();
            this.label14 = new System.Windows.Forms.Label();
            this.label16 = new System.Windows.Forms.Label();
            this.txtIgnoreFirst = new System.Windows.Forms.NumericUpDown();
            this.label17 = new System.Windows.Forms.Label();
            this.label20 = new System.Windows.Forms.Label();
            this.groupBox2 = new System.Windows.Forms.GroupBox();
            this.txtFieldLength = new System.Windows.Forms.NumericUpDown();
            this.label11 = new System.Windows.Forms.Label();
            this.cboFieldVisibility = new System.Windows.Forms.ComboBox();
            this.txtDefaultType = new System.Windows.Forms.ComboBox();
            this.txtNumberOfFields = new System.Windows.Forms.NumericUpDown();
            this.label10 = new System.Windows.Forms.Label();
            this.label9 = new System.Windows.Forms.Label();
            this.label6 = new System.Windows.Forms.Label();
            this.label1 = new System.Windows.Forms.Label();
            this.panStep3 = new System.Windows.Forms.Panel();
            this.browserTemplate = new System.Windows.Forms.WebBrowser();
            this.cboTemplate = new System.Windows.Forms.ComboBox();
            this.cboLanguage = new System.Windows.Forms.ComboBox();
            this.label4 = new System.Windows.Forms.Label();
            this.label3 = new System.Windows.Forms.Label();
            this.cmdSaveToFile = new System.Windows.Forms.Button();
            this.cmdToClipboard = new System.Windows.Forms.Button();
            this.label2 = new System.Windows.Forms.Label();
            this.panFields = new System.Windows.Forms.FlowLayoutPanel();
            this.panStep0 = new System.Windows.Forms.Panel();
            this.cboClassVisibility = new System.Windows.Forms.ComboBox();
            this.label8 = new System.Windows.Forms.Label();
            this.chkSealed = new System.Windows.Forms.CheckBox();
            this.groupBox5 = new System.Windows.Forms.GroupBox();
            this.txtClassName = new System.Windows.Forms.TextBox();
            this.groupBox8 = new System.Windows.Forms.GroupBox();
            this.label12 = new System.Windows.Forms.Label();
            this.cboFixedMode2 = new System.Windows.Forms.ComboBox();
            this.gbxDelimitedBy = new System.Windows.Forms.GroupBox();
            this.radDelTabs = new System.Windows.Forms.RadioButton();
            this.txtDelimiter = new System.Windows.Forms.TextBox();
            this.radDelCustom = new System.Windows.Forms.RadioButton();
            this.radDelVertBar = new System.Windows.Forms.RadioButton();
            this.radDelSemiCol = new System.Windows.Forms.RadioButton();
            this.radDelComma = new System.Windows.Forms.RadioButton();
            this.radDelimited = new System.Windows.Forms.RadioButton();
            this.radFixed = new System.Windows.Forms.RadioButton();
            this.label18 = new System.Windows.Forms.Label();
            this.picCurrent = new System.Windows.Forms.PictureBox();
            this.picNewVersion = new System.Windows.Forms.PictureBox();
            this.panStep2 = new System.Windows.Forms.Panel();
            this.chkAllQuoted = new System.Windows.Forms.CheckBox();
            this.chkAllTrim = new System.Windows.Forms.CheckBox();
            this.chkAllOptional = new System.Windows.Forms.CheckBox();
            this.cmdAddField = new System.Windows.Forms.Button();
            this.label15 = new System.Windows.Forms.Label();
            this.dlgSaveToFile = new System.Windows.Forms.SaveFileDialog();
            this.panel2 = new System.Windows.Forms.Panel();
            this.cmdTestClass = new System.Windows.Forms.Button();
            this.cmdLoad = new System.Windows.Forms.Button();
            this.cmdSave = new System.Windows.Forms.Button();
            this.cmdPreview = new System.Windows.Forms.Button();
            this.cmdBack = new System.Windows.Forms.Button();
            this.cmdNext = new System.Windows.Forms.Button();
            this.panPreview = new System.Windows.Forms.Panel();
            this.browserCode = new System.Windows.Forms.WebBrowser();
            this.cboClassLanguage = new System.Windows.Forms.ComboBox();
            this.label7 = new System.Windows.Forms.Label();
            this.pictureBox4 = new System.Windows.Forms.PictureBox();
            this.label5 = new System.Windows.Forms.Label();
            this.cmdSaveClass = new System.Windows.Forms.Button();
            this.cmdCopyClass = new System.Windows.Forms.Button();
            this.chkProperties = new System.Windows.Forms.CheckBox();
            this.dlgSaveWizard = new System.Windows.Forms.SaveFileDialog();
            this.dlgOpenWizard = new System.Windows.Forms.OpenFileDialog();
            this.toolTip1 = new System.Windows.Forms.ToolTip(this.components);
            this.picDonate = new System.Windows.Forms.PictureBox();
            this.panel1 = new System.Windows.Forms.Panel();
            this.cmdDetectFormatWithHeader = new System.Windows.Forms.Button();
            this.cmdfileDesigner = new System.Windows.Forms.Button();
            this.cmdDetectFormat = new System.Windows.Forms.Button();
            this.picCurrStep = new System.Windows.Forms.PictureBox();
            this.linkHome = new System.Windows.Forms.Label();
            this.pictureBox5 = new System.Windows.Forms.PictureBox();
            this.lblStep2 = new System.Windows.Forms.Label();
            this.lblStep3 = new System.Windows.Forms.Label();
            this.pictureBox1 = new System.Windows.Forms.PictureBox();
            this.cmdReset = new System.Windows.Forms.Button();
            this.pictureBox3 = new System.Windows.Forms.PictureBox();
            this.lblStep0 = new System.Windows.Forms.Label();
            this.lblStep1 = new System.Windows.Forms.Label();
            this.picFirstDark = new System.Windows.Forms.PictureBox();
            this.panel3 = new System.Windows.Forms.Panel();
            this.panel4 = new System.Windows.Forms.Panel();
            this.panStep1.SuspendLayout();
            this.groupBox4.SuspendLayout();
            this.groupBox3.SuspendLayout();
            this.groupBox1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.txtIgnoreLast)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.txtIgnoreFirst)).BeginInit();
            this.groupBox2.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.txtFieldLength)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.txtNumberOfFields)).BeginInit();
            this.panStep3.SuspendLayout();
            this.panStep0.SuspendLayout();
            this.groupBox5.SuspendLayout();
            this.groupBox8.SuspendLayout();
            this.gbxDelimitedBy.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picCurrent)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picNewVersion)).BeginInit();
            this.panStep2.SuspendLayout();
            this.panel2.SuspendLayout();
            this.panPreview.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picDonate)).BeginInit();
            this.panel1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picCurrStep)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox5)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picFirstDark)).BeginInit();
            this.panel3.SuspendLayout();
            this.panel4.SuspendLayout();
            this.SuspendLayout();
            // 
            // panStep1
            // 
            this.panStep1.BackColor = System.Drawing.Color.White;
            this.panStep1.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;
            this.panStep1.Controls.Add(this.groupBox4);
            this.panStep1.Controls.Add(this.groupBox3);
            this.panStep1.Controls.Add(this.groupBox1);
            this.panStep1.Controls.Add(this.groupBox2);
            this.panStep1.Controls.Add(this.label1);
            this.panStep1.Location = new System.Drawing.Point(170, 0);
            this.panStep1.Name = "panStep1";
            this.panStep1.Size = new System.Drawing.Size(400, 366);
            this.panStep1.TabIndex = 2;
            this.panStep1.TabStop = true;
            this.panStep1.Visible = false;
            // 
            // groupBox4
            // 
            this.groupBox4.Controls.Add(this.chkCommentAnyPlace);
            this.groupBox4.Controls.Add(this.label13);
            this.groupBox4.Controls.Add(this.txtCommentMarker);
            this.groupBox4.Location = new System.Drawing.Point(219, 191);
            this.groupBox4.Name = "groupBox4";
            this.groupBox4.Size = new System.Drawing.Size(166, 95);
            this.groupBox4.TabIndex = 13;
            this.groupBox4.TabStop = false;
            this.groupBox4.Text = "Commented Lines";
            // 
            // chkCommentAnyPlace
            // 
            this.chkCommentAnyPlace.Checked = true;
            this.chkCommentAnyPlace.CheckState = System.Windows.Forms.CheckState.Checked;
            this.chkCommentAnyPlace.Location = new System.Drawing.Point(15, 54);
            this.chkCommentAnyPlace.Name = "chkCommentAnyPlace";
            this.chkCommentAnyPlace.Size = new System.Drawing.Size(148, 30);
            this.chkCommentAnyPlace.TabIndex = 11;
            this.chkCommentAnyPlace.Text = "The comment can have spaces or tabs at left";
            this.chkCommentAnyPlace.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
            this.chkCommentAnyPlace.UseVisualStyleBackColor = true;
            this.chkCommentAnyPlace.CheckedChanged += new System.EventHandler(this.chkCommentAnyPlace_CheckedChanged);
            // 
            // label13
            // 
            this.label13.AutoSize = true;
            this.label13.Location = new System.Drawing.Point(12, 27);
            this.label13.Name = "label13";
            this.label13.Size = new System.Drawing.Size(88, 13);
            this.label13.TabIndex = 11;
            this.label13.Text = "Comment Marker";
            // 
            // txtCommentMarker
            // 
            this.txtCommentMarker.Location = new System.Drawing.Point(106, 24);
            this.txtCommentMarker.Name = "txtCommentMarker";
            this.txtCommentMarker.Size = new System.Drawing.Size(40, 21);
            this.txtCommentMarker.TabIndex = 12;
            this.toolTip1.SetToolTip(this.txtCommentMarker, "Allow you to ignore the lines that begin with this comment marker.");
            this.txtCommentMarker.TextChanged += new System.EventHandler(this.txtCommentMarker_TextChanged);
            // 
            // groupBox3
            // 
            this.groupBox3.Controls.Add(this.label21);
            this.groupBox3.Controls.Add(this.txtRecordConditionSelector);
            this.groupBox3.Controls.Add(this.cboRecordCondition);
            this.groupBox3.Controls.Add(this.label19);
            this.groupBox3.Location = new System.Drawing.Point(19, 288);
            this.groupBox3.Name = "groupBox3";
            this.groupBox3.Size = new System.Drawing.Size(366, 71);
            this.groupBox3.TabIndex = 12;
            this.groupBox3.TabStop = false;
            this.groupBox3.Text = "Conditional Records";
            // 
            // label21
            // 
            this.label21.AutoSize = true;
            this.label21.Location = new System.Drawing.Point(47, 47);
            this.label21.Name = "label21";
            this.label21.Size = new System.Drawing.Size(131, 13);
            this.label21.TabIndex = 1018;
            this.label21.Text = "Record Condition Selector";
            // 
            // txtRecordConditionSelector
            // 
            this.txtRecordConditionSelector.Location = new System.Drawing.Point(181, 44);
            this.txtRecordConditionSelector.Name = "txtRecordConditionSelector";
            this.txtRecordConditionSelector.Size = new System.Drawing.Size(137, 21);
            this.txtRecordConditionSelector.TabIndex = 1019;
            this.toolTip1.SetToolTip(this.txtRecordConditionSelector, "The selector used with the Record Condition");
            this.txtRecordConditionSelector.TextChanged += new System.EventHandler(this.txtRecordConditionSelector_TextChanged);
            // 
            // cboRecordCondition
            // 
            this.cboRecordCondition.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboRecordCondition.FormattingEnabled = true;
            this.cboRecordCondition.Location = new System.Drawing.Point(181, 20);
            this.cboRecordCondition.MaxDropDownItems = 15;
            this.cboRecordCondition.Name = "cboRecordCondition";
            this.cboRecordCondition.Size = new System.Drawing.Size(137, 21);
            this.cboRecordCondition.TabIndex = 1016;
            this.toolTip1.SetToolTip(this.cboRecordCondition, "Allow you to include or exclude certain records");
            this.cboRecordCondition.SelectedIndexChanged += new System.EventHandler(this.cboRecordCondition_SelectedIndexChanged);
            // 
            // label19
            // 
            this.label19.AutoSize = true;
            this.label19.Location = new System.Drawing.Point(47, 23);
            this.label19.Name = "label19";
            this.label19.Size = new System.Drawing.Size(89, 13);
            this.label19.TabIndex = 1017;
            this.label19.Text = "Record Condition";
            this.label19.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // groupBox1
            // 
            this.groupBox1.Controls.Add(this.chkIgnoreEmpty);
            this.groupBox1.Controls.Add(this.txtIgnoreLast);
            this.groupBox1.Controls.Add(this.label14);
            this.groupBox1.Controls.Add(this.label16);
            this.groupBox1.Controls.Add(this.txtIgnoreFirst);
            this.groupBox1.Controls.Add(this.label17);
            this.groupBox1.Controls.Add(this.label20);
            this.groupBox1.Location = new System.Drawing.Point(19, 191);
            this.groupBox1.Name = "groupBox1";
            this.groupBox1.Size = new System.Drawing.Size(194, 95);
            this.groupBox1.TabIndex = 11;
            this.groupBox1.TabStop = false;
            this.groupBox1.Text = "Ignore Lines";
            // 
            // chkIgnoreEmpty
            // 
            this.chkIgnoreEmpty.AutoSize = true;
            this.chkIgnoreEmpty.Location = new System.Drawing.Point(39, 70);
            this.chkIgnoreEmpty.Name = "chkIgnoreEmpty";
            this.chkIgnoreEmpty.Size = new System.Drawing.Size(118, 17);
            this.chkIgnoreEmpty.TabIndex = 1;
            this.chkIgnoreEmpty.Text = "Ignore Empty Lines";
            this.toolTip1.SetToolTip(this.chkIgnoreEmpty, "By Pass the empty lines");
            this.chkIgnoreEmpty.UseVisualStyleBackColor = true;
            this.chkIgnoreEmpty.CheckedChanged += new System.EventHandler(this.chkIgnoreEmpty_CheckedChanged);
            // 
            // txtIgnoreLast
            // 
            this.txtIgnoreLast.Location = new System.Drawing.Point(98, 43);
            this.txtIgnoreLast.Maximum = new decimal(new int[] {
            10000,
            0,
            0,
            0});
            this.txtIgnoreLast.Name = "txtIgnoreLast";
            this.txtIgnoreLast.Size = new System.Drawing.Size(44, 21);
            this.txtIgnoreLast.TabIndex = 8;
            this.txtIgnoreLast.TextAlign = System.Windows.Forms.HorizontalAlignment.Right;
            this.txtIgnoreLast.ValueChanged += new System.EventHandler(this.txtIgnoreLast_ValueChanged);
            // 
            // label14
            // 
            this.label14.AutoSize = true;
            this.label14.Location = new System.Drawing.Point(148, 46);
            this.label14.Name = "label14";
            this.label14.Size = new System.Drawing.Size(31, 13);
            this.label14.TabIndex = 9;
            this.label14.Text = "Lines";
            // 
            // label16
            // 
            this.label16.AutoSize = true;
            this.label16.Location = new System.Drawing.Point(10, 46);
            this.label16.Name = "label16";
            this.label16.Size = new System.Drawing.Size(81, 13);
            this.label16.TabIndex = 10;
            this.label16.Text = "Ignore the Last";
            // 
            // txtIgnoreFirst
            // 
            this.txtIgnoreFirst.Location = new System.Drawing.Point(98, 17);
            this.txtIgnoreFirst.Maximum = new decimal(new int[] {
            10000,
            0,
            0,
            0});
            this.txtIgnoreFirst.Name = "txtIgnoreFirst";
            this.txtIgnoreFirst.Size = new System.Drawing.Size(44, 21);
            this.txtIgnoreFirst.TabIndex = 0;
            this.txtIgnoreFirst.TextAlign = System.Windows.Forms.HorizontalAlignment.Right;
            this.txtIgnoreFirst.ValueChanged += new System.EventHandler(this.txtIgnoreFirst_ValueChanged);
            // 
            // label17
            // 
            this.label17.AutoSize = true;
            this.label17.Location = new System.Drawing.Point(148, 22);
            this.label17.Name = "label17";
            this.label17.Size = new System.Drawing.Size(31, 13);
            this.label17.TabIndex = 6;
            this.label17.Text = "Lines";
            // 
            // label20
            // 
            this.label20.AutoSize = true;
            this.label20.Location = new System.Drawing.Point(9, 19);
            this.label20.Name = "label20";
            this.label20.Size = new System.Drawing.Size(82, 13);
            this.label20.TabIndex = 7;
            this.label20.Text = "Ignore the First";
            // 
            // groupBox2
            // 
            this.groupBox2.Controls.Add(this.txtFieldLength);
            this.groupBox2.Controls.Add(this.label11);
            this.groupBox2.Controls.Add(this.cboFieldVisibility);
            this.groupBox2.Controls.Add(this.txtDefaultType);
            this.groupBox2.Controls.Add(this.txtNumberOfFields);
            this.groupBox2.Controls.Add(this.label10);
            this.groupBox2.Controls.Add(this.label9);
            this.groupBox2.Controls.Add(this.label6);
            this.groupBox2.Location = new System.Drawing.Point(18, 54);
            this.groupBox2.Name = "groupBox2";
            this.groupBox2.Size = new System.Drawing.Size(368, 131);
            this.groupBox2.TabIndex = 0;
            this.groupBox2.TabStop = false;
            this.groupBox2.Text = "Fields Options";
            // 
            // txtFieldLength
            // 
            this.txtFieldLength.Location = new System.Drawing.Point(154, 48);
            this.txtFieldLength.Maximum = new decimal(new int[] {
            100000,
            0,
            0,
            0});
            this.txtFieldLength.Minimum = new decimal(new int[] {
            1,
            0,
            0,
            0});
            this.txtFieldLength.Name = "txtFieldLength";
            this.txtFieldLength.Size = new System.Drawing.Size(84, 21);
            this.txtFieldLength.TabIndex = 10;
            this.txtFieldLength.TextAlign = System.Windows.Forms.HorizontalAlignment.Right;
            this.txtFieldLength.Value = new decimal(new int[] {
            10,
            0,
            0,
            0});
            // 
            // label11
            // 
            this.label11.AutoSize = true;
            this.label11.Location = new System.Drawing.Point(48, 51);
            this.label11.Name = "label11";
            this.label11.Size = new System.Drawing.Size(103, 13);
            this.label11.TabIndex = 9;
            this.label11.Text = "Default Field Length";
            this.label11.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // cboFieldVisibility
            // 
            this.cboFieldVisibility.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboFieldVisibility.FormattingEnabled = true;
            this.cboFieldVisibility.Location = new System.Drawing.Point(154, 102);
            this.cboFieldVisibility.Name = "cboFieldVisibility";
            this.cboFieldVisibility.Size = new System.Drawing.Size(84, 21);
            this.cboFieldVisibility.TabIndex = 2;
            this.cboFieldVisibility.SelectedIndexChanged += new System.EventHandler(this.cboFieldVisibility_SelectedIndexChanged);
            // 
            // txtDefaultType
            // 
            this.txtDefaultType.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.Suggest;
            this.txtDefaultType.FormattingEnabled = true;
            this.txtDefaultType.Items.AddRange(new object[] {
            "String",
            "DateTime",
            "Int16",
            "Int32",
            "Int64",
            "Decimal",
            "Double",
            "Single",
            "Boolean",
            "Byte",
            "SByte",
            "UInt16",
            "UInt32",
            "UInt64",
            "Guid",
            "Char"});
            this.txtDefaultType.Location = new System.Drawing.Point(154, 75);
            this.txtDefaultType.MaxDropDownItems = 20;
            this.txtDefaultType.Name = "txtDefaultType";
            this.txtDefaultType.Size = new System.Drawing.Size(84, 21);
            this.txtDefaultType.TabIndex = 1;
            this.txtDefaultType.Text = "String";
            // 
            // txtNumberOfFields
            // 
            this.txtNumberOfFields.Location = new System.Drawing.Point(154, 21);
            this.txtNumberOfFields.Maximum = new decimal(new int[] {
            50000,
            0,
            0,
            0});
            this.txtNumberOfFields.Name = "txtNumberOfFields";
            this.txtNumberOfFields.Size = new System.Drawing.Size(84, 21);
            this.txtNumberOfFields.TabIndex = 0;
            this.txtNumberOfFields.TextAlign = System.Windows.Forms.HorizontalAlignment.Right;
            this.txtNumberOfFields.Value = new decimal(new int[] {
            5,
            0,
            0,
            0});
            // 
            // label10
            // 
            this.label10.AutoSize = true;
            this.label10.Location = new System.Drawing.Point(48, 105);
            this.label10.Name = "label10";
            this.label10.Size = new System.Drawing.Size(69, 13);
            this.label10.TabIndex = 5;
            this.label10.Text = "Field Visibility";
            this.label10.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // label9
            // 
            this.label9.AutoSize = true;
            this.label9.Location = new System.Drawing.Point(48, 78);
            this.label9.Name = "label9";
            this.label9.Size = new System.Drawing.Size(94, 13);
            this.label9.TabIndex = 3;
            this.label9.Text = "Default Field Type";
            this.label9.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // label6
            // 
            this.label6.AutoSize = true;
            this.label6.Location = new System.Drawing.Point(48, 23);
            this.label6.Name = "label6";
            this.label6.Size = new System.Drawing.Size(87, 13);
            this.label6.TabIndex = 1;
            this.label6.Text = "Number of Fields";
            this.label6.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // label1
            // 
            this.label1.AutoSize = true;
            this.label1.BackColor = System.Drawing.Color.White;
            this.label1.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label1.Location = new System.Drawing.Point(11, 14);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(263, 19);
            this.label1.TabIndex = 0;
            this.label1.Text = "2. Record and Fields Properties";
            // 
            // panStep3
            // 
            this.panStep3.BackColor = System.Drawing.Color.White;
            this.panStep3.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;
            this.panStep3.Controls.Add(this.panel3);
            this.panStep3.Controls.Add(this.cboTemplate);
            this.panStep3.Controls.Add(this.cboLanguage);
            this.panStep3.Controls.Add(this.label4);
            this.panStep3.Controls.Add(this.label3);
            this.panStep3.Controls.Add(this.cmdSaveToFile);
            this.panStep3.Controls.Add(this.cmdToClipboard);
            this.panStep3.Controls.Add(this.label2);
            this.panStep3.Location = new System.Drawing.Point(170, 0);
            this.panStep3.Name = "panStep3";
            this.panStep3.Size = new System.Drawing.Size(400, 366);
            this.panStep3.TabIndex = 3;
            this.panStep3.TabStop = true;
            this.panStep3.Visible = false;
            // 
            // browserTemplate
            // 
            this.browserTemplate.Dock = System.Windows.Forms.DockStyle.Fill;
            this.browserTemplate.Location = new System.Drawing.Point(0, 0);
            this.browserTemplate.MinimumSize = new System.Drawing.Size(20, 20);
            this.browserTemplate.Name = "browserTemplate";
            this.browserTemplate.Size = new System.Drawing.Size(364, 254);
            this.browserTemplate.TabIndex = 1009;
            // 
            // cboTemplate
            // 
            this.cboTemplate.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboTemplate.Location = new System.Drawing.Point(70, 43);
            this.cboTemplate.MaxDropDownItems = 20;
            this.cboTemplate.Name = "cboTemplate";
            this.cboTemplate.Size = new System.Drawing.Size(176, 21);
            this.cboTemplate.Sorted = true;
            this.cboTemplate.TabIndex = 0;
            this.cboTemplate.SelectedIndexChanged += new System.EventHandler(this.cboTemplate_SelectedIndexChanged);
            // 
            // cboLanguage
            // 
            this.cboLanguage.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboLanguage.FormattingEnabled = true;
            this.cboLanguage.Location = new System.Drawing.Point(309, 43);
            this.cboLanguage.Name = "cboLanguage";
            this.cboLanguage.Size = new System.Drawing.Size(77, 21);
            this.cboLanguage.TabIndex = 1;
            this.cboLanguage.SelectedIndexChanged += new System.EventHandler(this.cboLanguage_SelectedIndexChanged);
            // 
            // label4
            // 
            this.label4.AutoSize = true;
            this.label4.Location = new System.Drawing.Point(257, 46);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(54, 13);
            this.label4.TabIndex = 10;
            this.label4.Text = "Language";
            // 
            // label3
            // 
            this.label3.AutoSize = true;
            this.label3.Location = new System.Drawing.Point(15, 46);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(51, 13);
            this.label3.TabIndex = 9;
            this.label3.Text = "Template";
            // 
            // cmdSaveToFile
            // 
            this.cmdSaveToFile.BackColor = System.Drawing.SystemColors.Control;
            this.cmdSaveToFile.Image = global::FileHelpers.WizardApp.Properties.Resources.disk;
            this.cmdSaveToFile.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdSaveToFile.Location = new System.Drawing.Point(18, 333);
            this.cmdSaveToFile.Name = "cmdSaveToFile";
            this.cmdSaveToFile.Size = new System.Drawing.Size(117, 28);
            this.cmdSaveToFile.TabIndex = 3;
            this.cmdSaveToFile.Text = "    Save to File ...";
            this.cmdSaveToFile.UseVisualStyleBackColor = true;
            this.cmdSaveToFile.Click += new System.EventHandler(this.cmdSaveToFile_Click);
            // 
            // cmdToClipboard
            // 
            this.cmdToClipboard.BackColor = System.Drawing.SystemColors.Control;
            this.cmdToClipboard.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.cmdToClipboard.Image = global::FileHelpers.WizardApp.Properties.Resources.page_copy;
            this.cmdToClipboard.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdToClipboard.Location = new System.Drawing.Point(246, 333);
            this.cmdToClipboard.Name = "cmdToClipboard";
            this.cmdToClipboard.Size = new System.Drawing.Size(139, 28);
            this.cmdToClipboard.TabIndex = 2;
            this.cmdToClipboard.Text = "    Copy to Clipboard";
            this.cmdToClipboard.UseVisualStyleBackColor = true;
            this.cmdToClipboard.Click += new System.EventHandler(this.cmdToClipboard_Click);
            // 
            // label2
            // 
            this.label2.AutoSize = true;
            this.label2.BackColor = System.Drawing.Color.White;
            this.label2.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label2.Location = new System.Drawing.Point(11, 14);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(249, 19);
            this.label2.TabIndex = 0;
            this.label2.Text = "4. Save and Usage Templates";
            // 
            // panFields
            // 
            this.panFields.AutoScroll = true;
            this.panFields.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(250)))), ((int)(((byte)(250)))), ((int)(((byte)(250)))));
            this.panFields.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.panFields.Location = new System.Drawing.Point(18, 40);
            this.panFields.Name = "panFields";
            this.panFields.Size = new System.Drawing.Size(374, 288);
            this.panFields.TabIndex = 0;
            this.panFields.TabStop = true;
            // 
            // panStep0
            // 
            this.panStep0.BackColor = System.Drawing.Color.White;
            this.panStep0.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;
            this.panStep0.Controls.Add(this.cboClassVisibility);
            this.panStep0.Controls.Add(this.label8);
            this.panStep0.Controls.Add(this.chkSealed);
            this.panStep0.Controls.Add(this.groupBox5);
            this.panStep0.Controls.Add(this.groupBox8);
            this.panStep0.Controls.Add(this.label18);
            this.panStep0.Controls.Add(this.picCurrent);
            this.panStep0.Controls.Add(this.picNewVersion);
            this.panStep0.Location = new System.Drawing.Point(170, 0);
            this.panStep0.Name = "panStep0";
            this.panStep0.Size = new System.Drawing.Size(400, 366);
            this.panStep0.TabIndex = 0;
            this.panStep0.TabStop = true;
            // 
            // cboClassVisibility
            // 
            this.cboClassVisibility.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboClassVisibility.FormattingEnabled = true;
            this.cboClassVisibility.Location = new System.Drawing.Point(148, 308);
            this.cboClassVisibility.Name = "cboClassVisibility";
            this.cboClassVisibility.Size = new System.Drawing.Size(84, 21);
            this.cboClassVisibility.TabIndex = 1014;
            this.toolTip1.SetToolTip(this.cboClassVisibility, "Set the visibility of your record class. ");
            this.cboClassVisibility.SelectedIndexChanged += new System.EventHandler(this.cboClassVisibility_SelectedIndexChanged);
            // 
            // label8
            // 
            this.label8.AutoSize = true;
            this.label8.Location = new System.Drawing.Point(34, 311);
            this.label8.Name = "label8";
            this.label8.Size = new System.Drawing.Size(109, 13);
            this.label8.TabIndex = 1015;
            this.label8.Text = "Record Class Visibility";
            this.label8.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // chkSealed
            // 
            this.chkSealed.Checked = true;
            this.chkSealed.CheckState = System.Windows.Forms.CheckState.Checked;
            this.chkSealed.Location = new System.Drawing.Point(37, 331);
            this.chkSealed.Name = "chkSealed";
            this.chkSealed.Size = new System.Drawing.Size(168, 31);
            this.chkSealed.TabIndex = 1013;
            this.chkSealed.Text = "Mark the class as sealed\r\n(for better performance)";
            this.toolTip1.SetToolTip(this.chkSealed, "Enhance the performance a bit with this option");
            this.chkSealed.UseVisualStyleBackColor = true;
            this.chkSealed.CheckedChanged += new System.EventHandler(this.chkSealed_CheckedChanged);
            // 
            // groupBox5
            // 
            this.groupBox5.Controls.Add(this.txtClassName);
            this.groupBox5.Location = new System.Drawing.Point(22, 55);
            this.groupBox5.Name = "groupBox5";
            this.groupBox5.Size = new System.Drawing.Size(343, 61);
            this.groupBox5.TabIndex = 0;
            this.groupBox5.TabStop = false;
            this.groupBox5.Text = "Record Class Name";
            // 
            // txtClassName
            // 
            this.txtClassName.Location = new System.Drawing.Point(16, 26);
            this.txtClassName.Name = "txtClassName";
            this.txtClassName.Size = new System.Drawing.Size(309, 21);
            this.txtClassName.TabIndex = 0;
            this.txtClassName.Text = "YourRecordClass";
            this.toolTip1.SetToolTip(this.txtClassName, "The name of the record class. Needs to be a valid identifier");
            this.txtClassName.TextChanged += new System.EventHandler(this.txtClassName_TextChanged);
            // 
            // groupBox8
            // 
            this.groupBox8.Controls.Add(this.label12);
            this.groupBox8.Controls.Add(this.cboFixedMode2);
            this.groupBox8.Controls.Add(this.gbxDelimitedBy);
            this.groupBox8.Controls.Add(this.radDelimited);
            this.groupBox8.Controls.Add(this.radFixed);
            this.groupBox8.Location = new System.Drawing.Point(22, 120);
            this.groupBox8.Name = "groupBox8";
            this.groupBox8.Size = new System.Drawing.Size(343, 179);
            this.groupBox8.TabIndex = 1;
            this.groupBox8.TabStop = false;
            this.groupBox8.Text = "Select the Record Type";
            // 
            // label12
            // 
            this.label12.AutoSize = true;
            this.label12.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(64)))), ((int)(((byte)(64)))), ((int)(((byte)(64)))));
            this.label12.Location = new System.Drawing.Point(168, 25);
            this.label12.Name = "label12";
            this.label12.Size = new System.Drawing.Size(59, 13);
            this.label12.TabIndex = 10;
            this.label12.Text = "FixedMode";
            this.label12.TextAlign = System.Drawing.ContentAlignment.TopRight;
            // 
            // cboFixedMode2
            // 
            this.cboFixedMode2.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboFixedMode2.FormattingEnabled = true;
            this.cboFixedMode2.Items.AddRange(new object[] {
            "public",
            "private",
            "internal",
            "protected"});
            this.cboFixedMode2.Location = new System.Drawing.Point(227, 21);
            this.cboFixedMode2.Name = "cboFixedMode2";
            this.cboFixedMode2.Size = new System.Drawing.Size(98, 21);
            this.cboFixedMode2.TabIndex = 9;
            this.toolTip1.SetToolTip(this.cboFixedMode2, "Indicates if the engines allow to found less or more chars in the last record");
            this.cboFixedMode2.SelectedIndexChanged += new System.EventHandler(this.cboFixedMode2_SelectedIndexChanged);
            // 
            // gbxDelimitedBy
            // 
            this.gbxDelimitedBy.Controls.Add(this.radDelTabs);
            this.gbxDelimitedBy.Controls.Add(this.txtDelimiter);
            this.gbxDelimitedBy.Controls.Add(this.radDelCustom);
            this.gbxDelimitedBy.Controls.Add(this.radDelVertBar);
            this.gbxDelimitedBy.Controls.Add(this.radDelSemiCol);
            this.gbxDelimitedBy.Controls.Add(this.radDelComma);
            this.gbxDelimitedBy.Enabled = false;
            this.gbxDelimitedBy.Location = new System.Drawing.Point(47, 61);
            this.gbxDelimitedBy.Name = "gbxDelimitedBy";
            this.gbxDelimitedBy.Size = new System.Drawing.Size(226, 111);
            this.gbxDelimitedBy.TabIndex = 4;
            this.gbxDelimitedBy.TabStop = false;
            // 
            // radDelTabs
            // 
            this.radDelTabs.AutoSize = true;
            this.radDelTabs.Location = new System.Drawing.Point(15, 16);
            this.radDelTabs.Name = "radDelTabs";
            this.radDelTabs.Size = new System.Drawing.Size(109, 17);
            this.radDelTabs.TabIndex = 5;
            this.radDelTabs.Text = "Delimited by Tabs";
            this.radDelTabs.UseVisualStyleBackColor = true;
            // 
            // txtDelimiter
            // 
            this.txtDelimiter.HideSelection = false;
            this.txtDelimiter.Location = new System.Drawing.Point(177, 83);
            this.txtDelimiter.MaxLength = 4;
            this.txtDelimiter.Name = "txtDelimiter";
            this.txtDelimiter.Size = new System.Drawing.Size(30, 21);
            this.txtDelimiter.TabIndex = 10;
            // 
            // radDelCustom
            // 
            this.radDelCustom.AutoSize = true;
            this.radDelCustom.Checked = true;
            this.radDelCustom.Location = new System.Drawing.Point(15, 84);
            this.radDelCustom.Name = "radDelCustom";
            this.radDelCustom.Size = new System.Drawing.Size(153, 17);
            this.radDelCustom.TabIndex = 9;
            this.radDelCustom.TabStop = true;
            this.radDelCustom.Text = "Delimited by Custom String";
            this.radDelCustom.UseVisualStyleBackColor = true;
            // 
            // radDelVertBar
            // 
            this.radDelVertBar.AutoSize = true;
            this.radDelVertBar.Location = new System.Drawing.Point(15, 33);
            this.radDelVertBar.Name = "radDelVertBar";
            this.radDelVertBar.Size = new System.Drawing.Size(140, 17);
            this.radDelVertBar.TabIndex = 6;
            this.radDelVertBar.Text = "Delimited by Vertical Bar";
            this.radDelVertBar.UseVisualStyleBackColor = true;
            // 
            // radDelSemiCol
            // 
            this.radDelSemiCol.AutoSize = true;
            this.radDelSemiCol.Location = new System.Drawing.Point(15, 67);
            this.radDelSemiCol.Name = "radDelSemiCol";
            this.radDelSemiCol.Size = new System.Drawing.Size(135, 17);
            this.radDelSemiCol.TabIndex = 8;
            this.radDelSemiCol.Text = "Delimited by SemiColon";
            this.radDelSemiCol.UseVisualStyleBackColor = true;
            // 
            // radDelComma
            // 
            this.radDelComma.AutoSize = true;
            this.radDelComma.Location = new System.Drawing.Point(15, 50);
            this.radDelComma.Name = "radDelComma";
            this.radDelComma.Size = new System.Drawing.Size(121, 17);
            this.radDelComma.TabIndex = 7;
            this.radDelComma.Text = "Delimited by Comma";
            this.radDelComma.UseVisualStyleBackColor = true;
            // 
            // radDelimited
            // 
            this.radDelimited.AutoSize = true;
            this.radDelimited.Location = new System.Drawing.Point(19, 48);
            this.radDelimited.Name = "radDelimited";
            this.radDelimited.Size = new System.Drawing.Size(146, 17);
            this.radDelimited.TabIndex = 3;
            this.radDelimited.Text = "Delimited Record Record:";
            this.radDelimited.UseVisualStyleBackColor = true;
            this.radDelimited.CheckedChanged += new System.EventHandler(this.radDelimited_CheckedChanged);
            // 
            // radFixed
            // 
            this.radFixed.AutoSize = true;
            this.radFixed.Checked = true;
            this.radFixed.Location = new System.Drawing.Point(19, 22);
            this.radFixed.Name = "radFixed";
            this.radFixed.Size = new System.Drawing.Size(124, 17);
            this.radFixed.TabIndex = 2;
            this.radFixed.TabStop = true;
            this.radFixed.Text = "Fixed Length Record";
            this.radFixed.UseVisualStyleBackColor = true;
            this.radFixed.CheckedChanged += new System.EventHandler(this.radFixed_CheckedChanged);
            // 
            // label18
            // 
            this.label18.AutoSize = true;
            this.label18.BackColor = System.Drawing.Color.White;
            this.label18.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label18.Location = new System.Drawing.Point(11, 14);
            this.label18.Name = "label18";
            this.label18.Size = new System.Drawing.Size(218, 19);
            this.label18.TabIndex = 0;
            this.label18.Text = "1. Select the Record Type";
            // 
            // picCurrent
            // 
            this.picCurrent.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.picCurrent.BackColor = System.Drawing.Color.Transparent;
            this.picCurrent.Image = ((System.Drawing.Image)(resources.GetObject("picCurrent.Image")));
            this.picCurrent.Location = new System.Drawing.Point(251, 310);
            this.picCurrent.Name = "picCurrent";
            this.picCurrent.Size = new System.Drawing.Size(146, 53);
            this.picCurrent.TabIndex = 1011;
            this.picCurrent.TabStop = false;
            this.picCurrent.Visible = false;
            // 
            // picNewVersion
            // 
            this.picNewVersion.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.picNewVersion.BackColor = System.Drawing.Color.Transparent;
            this.picNewVersion.Cursor = System.Windows.Forms.Cursors.Hand;
            this.picNewVersion.Image = ((System.Drawing.Image)(resources.GetObject("picNewVersion.Image")));
            this.picNewVersion.Location = new System.Drawing.Point(251, 310);
            this.picNewVersion.Name = "picNewVersion";
            this.picNewVersion.Size = new System.Drawing.Size(146, 53);
            this.picNewVersion.TabIndex = 1012;
            this.picNewVersion.TabStop = false;
            this.picNewVersion.Visible = false;
            this.picNewVersion.Click += new System.EventHandler(this.picNewVersion_Click);
            // 
            // panStep2
            // 
            this.panStep2.BackColor = System.Drawing.Color.White;
            this.panStep2.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;
            this.panStep2.Controls.Add(this.chkAllQuoted);
            this.panStep2.Controls.Add(this.chkAllTrim);
            this.panStep2.Controls.Add(this.chkAllOptional);
            this.panStep2.Controls.Add(this.panFields);
            this.panStep2.Controls.Add(this.cmdAddField);
            this.panStep2.Controls.Add(this.label15);
            this.panStep2.Location = new System.Drawing.Point(170, 0);
            this.panStep2.Name = "panStep2";
            this.panStep2.Size = new System.Drawing.Size(400, 366);
            this.panStep2.TabIndex = 10;
            this.panStep2.TabStop = true;
            this.panStep2.Visible = false;
            // 
            // chkAllQuoted
            // 
            this.chkAllQuoted.ImageAlign = System.Drawing.ContentAlignment.TopLeft;
            this.chkAllQuoted.Location = new System.Drawing.Point(258, 332);
            this.chkAllQuoted.Name = "chkAllQuoted";
            this.chkAllQuoted.Size = new System.Drawing.Size(121, 16);
            this.chkAllQuoted.TabIndex = 1014;
            this.chkAllQuoted.Text = "Mark all as Quoted";
            this.chkAllQuoted.TextAlign = System.Drawing.ContentAlignment.TopLeft;
            this.toolTip1.SetToolTip(this.chkAllQuoted, "Eseful for CSV files generated with Excel and multiline fields");
            this.chkAllQuoted.UseVisualStyleBackColor = true;
            this.chkAllQuoted.CheckedChanged += new System.EventHandler(this.chkAllQuoted_CheckedChanged);
            // 
            // chkAllTrim
            // 
            this.chkAllTrim.ImageAlign = System.Drawing.ContentAlignment.TopLeft;
            this.chkAllTrim.Location = new System.Drawing.Point(125, 348);
            this.chkAllTrim.Name = "chkAllTrim";
            this.chkAllTrim.Size = new System.Drawing.Size(134, 15);
            this.chkAllTrim.TabIndex = 1016;
            this.chkAllTrim.Text = "Mark all as Trim.Both";
            this.chkAllTrim.TextAlign = System.Drawing.ContentAlignment.TopLeft;
            this.toolTip1.SetToolTip(this.chkAllTrim, "Useful for Fixed Length Records");
            this.chkAllTrim.UseVisualStyleBackColor = true;
            this.chkAllTrim.CheckedChanged += new System.EventHandler(this.chkAllTrim_CheckedChanged);
            // 
            // chkAllOptional
            // 
            this.chkAllOptional.Location = new System.Drawing.Point(125, 331);
            this.chkAllOptional.Name = "chkAllOptional";
            this.chkAllOptional.Size = new System.Drawing.Size(131, 22);
            this.chkAllOptional.TabIndex = 1015;
            this.chkAllOptional.Text = "Mark all as Optional";
            this.chkAllOptional.TextAlign = System.Drawing.ContentAlignment.TopLeft;
            this.toolTip1.SetToolTip(this.chkAllOptional, "Useful for CSV files generated with Excel");
            this.chkAllOptional.UseVisualStyleBackColor = true;
            this.chkAllOptional.CheckedChanged += new System.EventHandler(this.chkAllOptional_CheckedChanged);
            // 
            // cmdAddField
            // 
            this.cmdAddField.BackColor = System.Drawing.SystemColors.Control;
            this.cmdAddField.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.cmdAddField.Image = ((System.Drawing.Image)(resources.GetObject("cmdAddField.Image")));
            this.cmdAddField.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdAddField.Location = new System.Drawing.Point(18, 332);
            this.cmdAddField.Name = "cmdAddField";
            this.cmdAddField.Size = new System.Drawing.Size(101, 28);
            this.cmdAddField.TabIndex = 4;
            this.cmdAddField.Text = "   Add Field";
            this.cmdAddField.UseVisualStyleBackColor = true;
            this.cmdAddField.Click += new System.EventHandler(this.cmdAddField_Click);
            // 
            // label15
            // 
            this.label15.AutoSize = true;
            this.label15.BackColor = System.Drawing.Color.White;
            this.label15.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label15.Location = new System.Drawing.Point(11, 14);
            this.label15.Name = "label15";
            this.label15.Size = new System.Drawing.Size(215, 19);
            this.label15.TabIndex = 0;
            this.label15.Text = "3. Record Fields Designer";
            // 
            // dlgSaveToFile
            // 
            this.dlgSaveToFile.DefaultExt = "cs";
            this.dlgSaveToFile.Filter = "C# files|*.cs|VB.Net Files|*.vb|All Files|*.*";
            this.dlgSaveToFile.Title = "Save the output to a file.";
            // 
            // panel2
            // 
            this.panel2.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.panel2.Controls.Add(this.cmdTestClass);
            this.panel2.Controls.Add(this.cmdLoad);
            this.panel2.Controls.Add(this.cmdSave);
            this.panel2.Controls.Add(this.cmdPreview);
            this.panel2.Controls.Add(this.cmdBack);
            this.panel2.Controls.Add(this.cmdNext);
            this.panel2.Location = new System.Drawing.Point(-10, 366);
            this.panel2.Name = "panel2";
            this.panel2.Size = new System.Drawing.Size(587, 51);
            this.panel2.TabIndex = 1000;
            // 
            // cmdTestClass
            // 
            this.cmdTestClass.Image = global::FileHelpers.WizardApp.Properties.Resources.tick;
            this.cmdTestClass.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdTestClass.Location = new System.Drawing.Point(14, 6);
            this.cmdTestClass.Name = "cmdTestClass";
            this.cmdTestClass.Size = new System.Drawing.Size(86, 28);
            this.cmdTestClass.TabIndex = 1008;
            this.cmdTestClass.Text = "      Test Class";
            this.cmdTestClass.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdTestClass.UseVisualStyleBackColor = true;
            this.cmdTestClass.Click += new System.EventHandler(this.cmdTestClass_Click);
            // 
            // cmdLoad
            // 
            this.cmdLoad.Image = global::FileHelpers.WizardApp.Properties.Resources.folder_table;
            this.cmdLoad.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdLoad.Location = new System.Drawing.Point(105, 6);
            this.cmdLoad.Name = "cmdLoad";
            this.cmdLoad.Size = new System.Drawing.Size(82, 28);
            this.cmdLoad.TabIndex = 1102;
            this.cmdLoad.Text = "Load Xml";
            this.cmdLoad.TextAlign = System.Drawing.ContentAlignment.MiddleRight;
            this.cmdLoad.UseVisualStyleBackColor = true;
            this.cmdLoad.Click += new System.EventHandler(this.cmdLoad_Click);
            // 
            // cmdSave
            // 
            this.cmdSave.Enabled = false;
            this.cmdSave.Image = global::FileHelpers.WizardApp.Properties.Resources.disk;
            this.cmdSave.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdSave.Location = new System.Drawing.Point(192, 6);
            this.cmdSave.Name = "cmdSave";
            this.cmdSave.Size = new System.Drawing.Size(83, 28);
            this.cmdSave.TabIndex = 1101;
            this.cmdSave.Text = "Save Xml";
            this.cmdSave.TextAlign = System.Drawing.ContentAlignment.MiddleRight;
            this.cmdSave.UseVisualStyleBackColor = true;
            this.cmdSave.Click += new System.EventHandler(this.cmdSave_Click);
            // 
            // cmdPreview
            // 
            this.cmdPreview.Enabled = false;
            this.cmdPreview.Image = ((System.Drawing.Image)(resources.GetObject("cmdPreview.Image")));
            this.cmdPreview.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdPreview.Location = new System.Drawing.Point(480, 6);
            this.cmdPreview.Name = "cmdPreview";
            this.cmdPreview.Size = new System.Drawing.Size(91, 28);
            this.cmdPreview.TabIndex = 1011;
            this.cmdPreview.Text = "&Preview >>";
            this.cmdPreview.TextAlign = System.Drawing.ContentAlignment.MiddleRight;
            this.cmdPreview.UseVisualStyleBackColor = true;
            this.cmdPreview.Click += new System.EventHandler(this.cmdPreview_Click);
            // 
            // cmdBack
            // 
            this.cmdBack.Enabled = false;
            this.cmdBack.Image = ((System.Drawing.Image)(resources.GetObject("cmdBack.Image")));
            this.cmdBack.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdBack.Location = new System.Drawing.Point(304, 6);
            this.cmdBack.Name = "cmdBack";
            this.cmdBack.Size = new System.Drawing.Size(83, 28);
            this.cmdBack.TabIndex = 1009;
            this.cmdBack.Text = "   &Back";
            this.cmdBack.UseVisualStyleBackColor = true;
            this.cmdBack.Click += new System.EventHandler(this.cmdBack_Click);
            // 
            // cmdNext
            // 
            this.cmdNext.Image = ((System.Drawing.Image)(resources.GetObject("cmdNext.Image")));
            this.cmdNext.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdNext.Location = new System.Drawing.Point(392, 6);
            this.cmdNext.Name = "cmdNext";
            this.cmdNext.Size = new System.Drawing.Size(83, 28);
            this.cmdNext.TabIndex = 1010;
            this.cmdNext.Text = "   &Next";
            this.cmdNext.TextImageRelation = System.Windows.Forms.TextImageRelation.TextBeforeImage;
            this.cmdNext.UseVisualStyleBackColor = true;
            this.cmdNext.Click += new System.EventHandler(this.cmdNext_Click);
            // 
            // panPreview
            // 
            this.panPreview.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.panPreview.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.panPreview.Controls.Add(this.panel4);
            this.panPreview.Controls.Add(this.cboClassLanguage);
            this.panPreview.Controls.Add(this.label7);
            this.panPreview.Controls.Add(this.pictureBox4);
            this.panPreview.Controls.Add(this.label5);
            this.panPreview.Controls.Add(this.cmdSaveClass);
            this.panPreview.Controls.Add(this.cmdCopyClass);
            this.panPreview.Controls.Add(this.chkProperties);
            this.panPreview.Location = new System.Drawing.Point(568, 0);
            this.panPreview.Name = "panPreview";
            this.panPreview.Size = new System.Drawing.Size(441, 412);
            this.panPreview.TabIndex = 1002;
            // 
            // browserCode
            // 
            this.browserCode.Dock = System.Windows.Forms.DockStyle.Fill;
            this.browserCode.Location = new System.Drawing.Point(0, 0);
            this.browserCode.MinimumSize = new System.Drawing.Size(20, 20);
            this.browserCode.Name = "browserCode";
            this.browserCode.Size = new System.Drawing.Size(416, 294);
            this.browserCode.TabIndex = 1008;
            // 
            // cboClassLanguage
            // 
            this.cboClassLanguage.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.cboClassLanguage.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cboClassLanguage.FormattingEnabled = true;
            this.cboClassLanguage.Location = new System.Drawing.Point(372, 30);
            this.cboClassLanguage.Name = "cboClassLanguage";
            this.cboClassLanguage.Size = new System.Drawing.Size(60, 21);
            this.cboClassLanguage.TabIndex = 1004;
            this.cboClassLanguage.SelectedIndexChanged += new System.EventHandler(this.cboClassLanguage_SelectedIndexChanged);
            // 
            // label7
            // 
            this.label7.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.label7.AutoSize = true;
            this.label7.Location = new System.Drawing.Point(315, 34);
            this.label7.Name = "label7";
            this.label7.Size = new System.Drawing.Size(54, 13);
            this.label7.TabIndex = 1005;
            this.label7.Text = "Language";
            // 
            // pictureBox4
            // 
            this.pictureBox4.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox4.Image")));
            this.pictureBox4.Location = new System.Drawing.Point(5, -1);
            this.pictureBox4.Name = "pictureBox4";
            this.pictureBox4.Size = new System.Drawing.Size(32, 32);
            this.pictureBox4.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox4.TabIndex = 1003;
            this.pictureBox4.TabStop = false;
            // 
            // label5
            // 
            this.label5.AutoSize = true;
            this.label5.BackColor = System.Drawing.Color.Transparent;
            this.label5.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label5.ForeColor = System.Drawing.Color.Navy;
            this.label5.Location = new System.Drawing.Point(51, 6);
            this.label5.Name = "label5";
            this.label5.Size = new System.Drawing.Size(184, 19);
            this.label5.TabIndex = 1002;
            this.label5.Text = "Record Class Preview";
            // 
            // cmdSaveClass
            // 
            this.cmdSaveClass.Image = global::FileHelpers.WizardApp.Properties.Resources.disk;
            this.cmdSaveClass.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdSaveClass.Location = new System.Drawing.Point(5, 371);
            this.cmdSaveClass.Name = "cmdSaveClass";
            this.cmdSaveClass.Size = new System.Drawing.Size(92, 28);
            this.cmdSaveClass.TabIndex = 11;
            this.cmdSaveClass.Text = "Save Class";
            this.cmdSaveClass.TextAlign = System.Drawing.ContentAlignment.MiddleRight;
            this.cmdSaveClass.UseVisualStyleBackColor = true;
            this.cmdSaveClass.Click += new System.EventHandler(this.cmdSaveClass_Click);
            // 
            // cmdCopyClass
            // 
            this.cmdCopyClass.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.cmdCopyClass.Image = ((System.Drawing.Image)(resources.GetObject("cmdCopyClass.Image")));
            this.cmdCopyClass.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdCopyClass.Location = new System.Drawing.Point(103, 371);
            this.cmdCopyClass.Name = "cmdCopyClass";
            this.cmdCopyClass.Size = new System.Drawing.Size(93, 28);
            this.cmdCopyClass.TabIndex = 11;
            this.cmdCopyClass.Text = "      Copy Class";
            this.cmdCopyClass.UseVisualStyleBackColor = true;
            this.cmdCopyClass.Click += new System.EventHandler(this.cmdCopyClass_Click);
            // 
            // chkProperties
            // 
            this.chkProperties.AutoSize = true;
            this.chkProperties.Location = new System.Drawing.Point(6, 36);
            this.chkProperties.Name = "chkProperties";
            this.chkProperties.Size = new System.Drawing.Size(111, 17);
            this.chkProperties.TabIndex = 1007;
            this.chkProperties.Text = "Create Properties";
            this.chkProperties.UseVisualStyleBackColor = true;
            this.chkProperties.CheckedChanged += new System.EventHandler(this.chkProperties_CheckedChanged);
            // 
            // dlgSaveWizard
            // 
            this.dlgSaveWizard.DefaultExt = "fhw";
            this.dlgSaveWizard.Filter = "File Helpers Wizard (*.fhw) |*.fhw";
            this.dlgSaveWizard.Title = "Save the Record Info to a File";
            // 
            // dlgOpenWizard
            // 
            this.dlgOpenWizard.DefaultExt = "fhw";
            this.dlgOpenWizard.FileName = "openFileDialog1";
            this.dlgOpenWizard.Filter = "File Helpers Wizard (*.fhw) |*.fhw";
            this.dlgOpenWizard.Title = "Load a Previous Record info";
            // 
            // toolTip1
            // 
            this.toolTip1.IsBalloon = true;
            this.toolTip1.ShowAlways = true;
            // 
            // picDonate
            // 
            this.picDonate.Cursor = System.Windows.Forms.Cursors.Hand;
            this.picDonate.Image = ((System.Drawing.Image)(resources.GetObject("picDonate.Image")));
            this.picDonate.Location = new System.Drawing.Point(469, 0);
            this.picDonate.Name = "picDonate";
            this.picDonate.Size = new System.Drawing.Size(100, 36);
            this.picDonate.TabIndex = 1010;
            this.picDonate.TabStop = false;
            this.toolTip1.SetToolTip(this.picDonate, "Is day by day harder to main the library.\r\nClick here to find out about\r\nhow you " +
        "can donate to the project.\r\n\r\nSome money will help keep FileHelpers active\r\n\r\nTh" +
        "anks");
            this.picDonate.Click += new System.EventHandler(this.picDonate_Click);
            // 
            // panel1
            // 
            this.panel1.BackgroundImage = ((System.Drawing.Image)(resources.GetObject("panel1.BackgroundImage")));
            this.panel1.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;
            this.panel1.Controls.Add(this.cmdDetectFormatWithHeader);
            this.panel1.Controls.Add(this.cmdfileDesigner);
            this.panel1.Controls.Add(this.cmdDetectFormat);
            this.panel1.Controls.Add(this.picCurrStep);
            this.panel1.Controls.Add(this.linkHome);
            this.panel1.Controls.Add(this.pictureBox5);
            this.panel1.Controls.Add(this.lblStep2);
            this.panel1.Controls.Add(this.lblStep3);
            this.panel1.Controls.Add(this.pictureBox1);
            this.panel1.Controls.Add(this.cmdReset);
            this.panel1.Controls.Add(this.pictureBox3);
            this.panel1.Controls.Add(this.lblStep0);
            this.panel1.Controls.Add(this.lblStep1);
            this.panel1.Controls.Add(this.picFirstDark);
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(172, 366);
            this.panel1.TabIndex = 9;
            // 
            // cmdDetectFormatWithHeader
            // 
            this.cmdDetectFormatWithHeader.BackColor = System.Drawing.Color.LightSteelBlue;
            this.cmdDetectFormatWithHeader.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.cmdDetectFormatWithHeader.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(70)))), ((int)(((byte)(70)))), ((int)(((byte)(70)))));
            this.cmdDetectFormatWithHeader.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdDetectFormatWithHeader.Location = new System.Drawing.Point(9, 329);
            this.cmdDetectFormatWithHeader.Name = "cmdDetectFormatWithHeader";
            this.cmdDetectFormatWithHeader.Size = new System.Drawing.Size(155, 25);
            this.cmdDetectFormatWithHeader.TabIndex = 1103;
            this.cmdDetectFormatWithHeader.Text = "Auto Detect With Headers";
            this.cmdDetectFormatWithHeader.UseVisualStyleBackColor = false;
            this.cmdDetectFormatWithHeader.Click += new System.EventHandler(this.cmdDetectFormatWithHeader_Click);
            // 
            // cmdfileDesigner
            // 
            this.cmdfileDesigner.BackColor = System.Drawing.Color.LightSteelBlue;
            this.cmdfileDesigner.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.cmdfileDesigner.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(70)))), ((int)(((byte)(70)))), ((int)(((byte)(70)))));
            this.cmdfileDesigner.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdfileDesigner.Location = new System.Drawing.Point(8, 267);
            this.cmdfileDesigner.Name = "cmdfileDesigner";
            this.cmdfileDesigner.Size = new System.Drawing.Size(156, 25);
            this.cmdfileDesigner.TabIndex = 1102;
            this.cmdfileDesigner.Text = "Fixed Width Designer";
            this.cmdfileDesigner.UseVisualStyleBackColor = false;
            this.cmdfileDesigner.Visible = false;
            this.cmdfileDesigner.Click += new System.EventHandler(this.cmdfileDesigner_Click);
            // 
            // cmdDetectFormat
            // 
            this.cmdDetectFormat.BackColor = System.Drawing.Color.LightSteelBlue;
            this.cmdDetectFormat.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.cmdDetectFormat.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(70)))), ((int)(((byte)(70)))), ((int)(((byte)(70)))));
            this.cmdDetectFormat.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdDetectFormat.Location = new System.Drawing.Point(9, 298);
            this.cmdDetectFormat.Name = "cmdDetectFormat";
            this.cmdDetectFormat.Size = new System.Drawing.Size(155, 25);
            this.cmdDetectFormat.TabIndex = 1101;
            this.cmdDetectFormat.Text = "Auto Detect Format";
            this.cmdDetectFormat.UseVisualStyleBackColor = false;
            this.cmdDetectFormat.Click += new System.EventHandler(this.cmdDetectFormat_Click);
            // 
            // picCurrStep
            // 
            this.picCurrStep.BackColor = System.Drawing.Color.Transparent;
            this.picCurrStep.Image = ((System.Drawing.Image)(resources.GetObject("picCurrStep.Image")));
            this.picCurrStep.Location = new System.Drawing.Point(8, 70);
            this.picCurrStep.Name = "picCurrStep";
            this.picCurrStep.Size = new System.Drawing.Size(20, 20);
            this.picCurrStep.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.picCurrStep.TabIndex = 7;
            this.picCurrStep.TabStop = false;
            // 
            // linkHome
            // 
            this.linkHome.BackColor = System.Drawing.Color.Transparent;
            this.linkHome.Location = new System.Drawing.Point(-1, -1);
            this.linkHome.Name = "linkHome";
            this.linkHome.Size = new System.Drawing.Size(165, 68);
            this.linkHome.TabIndex = 1010;
            this.linkHome.Click += new System.EventHandler(this.linkHome_Click);
            // 
            // pictureBox5
            // 
            this.pictureBox5.BackColor = System.Drawing.Color.Transparent;
            this.pictureBox5.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox5.Image")));
            this.pictureBox5.Location = new System.Drawing.Point(8, 145);
            this.pictureBox5.Name = "pictureBox5";
            this.pictureBox5.Size = new System.Drawing.Size(20, 20);
            this.pictureBox5.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox5.TabIndex = 13;
            this.pictureBox5.TabStop = false;
            // 
            // lblStep2
            // 
            this.lblStep2.BackColor = System.Drawing.Color.Transparent;
            this.lblStep2.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblStep2.ForeColor = System.Drawing.Color.DarkGray;
            this.lblStep2.Location = new System.Drawing.Point(29, 124);
            this.lblStep2.Name = "lblStep2";
            this.lblStep2.Size = new System.Drawing.Size(135, 16);
            this.lblStep2.TabIndex = 12;
            this.lblStep2.Text = "Record Fields Designer";
            // 
            // lblStep3
            // 
            this.lblStep3.BackColor = System.Drawing.Color.Transparent;
            this.lblStep3.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblStep3.ForeColor = System.Drawing.Color.DarkGray;
            this.lblStep3.Location = new System.Drawing.Point(29, 149);
            this.lblStep3.Name = "lblStep3";
            this.lblStep3.Size = new System.Drawing.Size(115, 20);
            this.lblStep3.TabIndex = 11;
            this.lblStep3.Text = "Live Templates";
            // 
            // pictureBox1
            // 
            this.pictureBox1.BackColor = System.Drawing.Color.Transparent;
            this.pictureBox1.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox1.Image")));
            this.pictureBox1.Location = new System.Drawing.Point(8, 120);
            this.pictureBox1.Name = "pictureBox1";
            this.pictureBox1.Size = new System.Drawing.Size(20, 20);
            this.pictureBox1.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox1.TabIndex = 8;
            this.pictureBox1.TabStop = false;
            // 
            // cmdReset
            // 
            this.cmdReset.BackColor = System.Drawing.Color.LightSteelBlue;
            this.cmdReset.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.cmdReset.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(70)))), ((int)(((byte)(70)))), ((int)(((byte)(70)))));
            this.cmdReset.Image = ((System.Drawing.Image)(resources.GetObject("cmdReset.Image")));
            this.cmdReset.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdReset.Location = new System.Drawing.Point(38, 172);
            this.cmdReset.Name = "cmdReset";
            this.cmdReset.Size = new System.Drawing.Size(83, 25);
            this.cmdReset.TabIndex = 1100;
            this.cmdReset.Text = "      Reset All";
            this.cmdReset.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.cmdReset.UseVisualStyleBackColor = false;
            this.cmdReset.Click += new System.EventHandler(this.cmdReset_Click);
            // 
            // pictureBox3
            // 
            this.pictureBox3.BackColor = System.Drawing.Color.Transparent;
            this.pictureBox3.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox3.Image")));
            this.pictureBox3.Location = new System.Drawing.Point(8, 95);
            this.pictureBox3.Name = "pictureBox3";
            this.pictureBox3.Size = new System.Drawing.Size(20, 20);
            this.pictureBox3.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox3.TabIndex = 9;
            this.pictureBox3.TabStop = false;
            // 
            // lblStep0
            // 
            this.lblStep0.BackColor = System.Drawing.Color.Transparent;
            this.lblStep0.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblStep0.ForeColor = System.Drawing.Color.White;
            this.lblStep0.Location = new System.Drawing.Point(29, 73);
            this.lblStep0.Name = "lblStep0";
            this.lblStep0.Size = new System.Drawing.Size(130, 20);
            this.lblStep0.TabIndex = 10;
            this.lblStep0.Text = "Record Properties";
            // 
            // lblStep1
            // 
            this.lblStep1.BackColor = System.Drawing.Color.Transparent;
            this.lblStep1.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblStep1.ForeColor = System.Drawing.Color.DarkGray;
            this.lblStep1.Location = new System.Drawing.Point(29, 99);
            this.lblStep1.Name = "lblStep1";
            this.lblStep1.Size = new System.Drawing.Size(130, 16);
            this.lblStep1.TabIndex = 9;
            this.lblStep1.Text = "Common Properties";
            // 
            // picFirstDark
            // 
            this.picFirstDark.BackColor = System.Drawing.Color.Transparent;
            this.picFirstDark.Image = ((System.Drawing.Image)(resources.GetObject("picFirstDark.Image")));
            this.picFirstDark.Location = new System.Drawing.Point(8, 70);
            this.picFirstDark.Name = "picFirstDark";
            this.picFirstDark.Size = new System.Drawing.Size(20, 20);
            this.picFirstDark.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.picFirstDark.TabIndex = 4;
            this.picFirstDark.TabStop = false;
            // 
            // panel3
            // 
            this.panel3.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
            | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.panel3.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.panel3.Controls.Add(this.browserTemplate);
            this.panel3.Location = new System.Drawing.Point(18, 70);
            this.panel3.Name = "panel3";
            this.panel3.Size = new System.Drawing.Size(368, 258);
            this.panel3.TabIndex = 1010;
            // 
            // panel4
            // 
            this.panel4.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
            | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.panel4.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.panel4.Controls.Add(this.browserCode);
            this.panel4.Location = new System.Drawing.Point(6, 59);
            this.panel4.Name = "panel4";
            this.panel4.Size = new System.Drawing.Size(420, 298);
            this.panel4.TabIndex = 1009;
            // 
            // frmWizard
            // 
            this.AutoScaleBaseSize = new System.Drawing.Size(5, 14);
            this.ClientSize = new System.Drawing.Size(1008, 402);
            this.Controls.Add(this.picDonate);
            this.Controls.Add(this.panel1);
            this.Controls.Add(this.panel2);
            this.Controls.Add(this.panStep3);
            this.Controls.Add(this.panStep0);
            this.Controls.Add(this.panStep1);
            this.Controls.Add(this.panPreview);
            this.Controls.Add(this.panStep2);
            this.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Location = new System.Drawing.Point(50, 120);
            this.MaximumSize = new System.Drawing.Size(1024, 440);
            this.MinimumSize = new System.Drawing.Size(577, 440);
            this.Name = "frmWizard";
            this.StartPosition = System.Windows.Forms.FormStartPosition.Manual;
            this.Text = "FileHelpers - Record Class Wizard v2.0";
            this.Activated += new System.EventHandler(this.frmWizard_Activated);
            this.Load += new System.EventHandler(this.frmWizard_Load);
            this.panStep1.ResumeLayout(false);
            this.panStep1.PerformLayout();
            this.groupBox4.ResumeLayout(false);
            this.groupBox4.PerformLayout();
            this.groupBox3.ResumeLayout(false);
            this.groupBox3.PerformLayout();
            this.groupBox1.ResumeLayout(false);
            this.groupBox1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.txtIgnoreLast)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.txtIgnoreFirst)).EndInit();
            this.groupBox2.ResumeLayout(false);
            this.groupBox2.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.txtFieldLength)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.txtNumberOfFields)).EndInit();
            this.panStep3.ResumeLayout(false);
            this.panStep3.PerformLayout();
            this.panStep0.ResumeLayout(false);
            this.panStep0.PerformLayout();
            this.groupBox5.ResumeLayout(false);
            this.groupBox5.PerformLayout();
            this.groupBox8.ResumeLayout(false);
            this.groupBox8.PerformLayout();
            this.gbxDelimitedBy.ResumeLayout(false);
            this.gbxDelimitedBy.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picCurrent)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picNewVersion)).EndInit();
            this.panStep2.ResumeLayout(false);
            this.panStep2.PerformLayout();
            this.panel2.ResumeLayout(false);
            this.panPreview.ResumeLayout(false);
            this.panPreview.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picDonate)).EndInit();
            this.panel1.ResumeLayout(false);
            this.panel1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picCurrStep)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox5)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picFirstDark)).EndInit();
            this.panel3.ResumeLayout(false);
            this.panel4.ResumeLayout(false);
            this.ResumeLayout(false);

        }
        #endregion

        #endregion

  

        /// <summary>
        /// Class information stored here.
        /// </summary>
        WizardInfo mWizardInfo = new WizardInfo();


        private void frmWizard_Load(object sender, EventArgs e)
        {
            mMoving = true;
            txtClassName.SelectAll();
            cboFixedMode2.DataSource = Enum.GetValues(typeof(FixedMode));
            
            cboFieldVisibility.DataSource = Enum.GetValues(typeof(NetVisibility));
            cboClassVisibility.DataSource = new NetVisibility[] { NetVisibility.Public, NetVisibility.Internal};
            cboRecordCondition.DataSource = Enum.GetValues(typeof(RecordCondition));
            cboLanguage.Items.Clear();
            cboLanguage.Items.AddRange(NetLanguageList.Languages.ToArray());
            cboLanguage.SelectedIndex = 0;
            cboClassLanguage.Items.Clear();
            cboClassLanguage.Items.AddRange(NetLanguageList.Languages.ToArray());
            cboClassLanguage.SelectedIndex = 0;
            mMoving = false;
            picCurrStep.BringToFront();

        }

        bool mFirstTime = true;


        bool mMoving = false;
        private void cmdNext_Click(object sender, EventArgs e)
        {
            mMoving = true;
            if (panStep0.Visible)
            {
                if (ProcessStep0())
                {
                    panStep1.Show();
                    lblStep1.ForeColor = Color.White;

                    picCurrStep.Top += 25;

                    panStep0.Hide();
                    lblStep0.ForeColor = Color.DarkGray;

                    txtNumberOfFields.Focus();
                    cmdBack.Enabled = true;

                    if (mWizardInfo.ClassBuilder != null)
                        ReLoadPreview();
                }
            }
            else if (panStep1.Visible)
            {
                if (ProcessStep1())
                {
                    panStep2.Show();
                    lblStep2.ForeColor = Color.White;

                    picCurrStep.Top += 25;

                    panStep1.Hide();
                    lblStep1.ForeColor = Color.DarkGray;

                    if (panFields.Controls.Count > 0)
                        panFields.Controls[0].Focus();

                    cmdSave.Enabled = true;
                }
            }
            else if (panStep2.Visible)
            {
                if (ProcessStep2())
                {
                    panStep3.Show();
                    lblStep3.ForeColor = Color.White;

                    picCurrStep.Top += 25;

                    panStep2.Hide();
                    lblStep2.ForeColor = Color.DarkGray;
                    cmdNext.Enabled = false;

                }
            }
            mMoving = false;


        }

        Type mControlType;
        Type mFieldType;

        #region "  ProcessStep0  "

        private bool ProcessStep0()
        {

            //lstFields.DataSource = mFields;

            if (txtClassName.Text.Trim().Length == 0)
            {
                MessageBox.Show("You need to define the Class Name", "Validation Error");
                txtClassName.Focus();
                return false;
            }


            if (radDelimited.Checked && radDelCustom.Checked && txtDelimiter.Text.Trim().Length == 0)
            {
                MessageBox.Show("You need to define the Delimiter if you use a Custom Delimiter", "Validation Error");
                txtDelimiter.Focus();
                return false;
            }


            ClassBuilder ant = mWizardInfo.ClassBuilder;
            if (radFixed.Checked)
            {
                if (mWizardInfo.FixedLengthBuilder != null)
                      return true;

                mWizardInfo.ClassBuilder = new FixedLengthClassBuilder(txtClassName.Text);
                mWizardInfo.FixedLengthBuilder.FixedMode = (FixedMode)cboFixedMode2.SelectedItem;

                mWizardInfo.ClassBuilder.Visibility = (NetVisibility) cboClassVisibility.SelectedItem;
                mWizardInfo.ClassBuilder.SealedClass = chkSealed.Checked;

                mControlType = typeof(FieldFixedControl);
                mFieldType = typeof(FixedFieldBuilder);

                txtFieldLength.Enabled = true;

                if (ant != null)
                {
                    mWizardInfo.ClassBuilder.ClassName = ant.ClassName;
                    mWizardInfo.ClassBuilder.GenerateProperties = ant.GenerateProperties;
                    mWizardInfo.ClassBuilder.IgnoreEmptyLines = ant.IgnoreEmptyLines;
                    mWizardInfo.ClassBuilder.IgnoreFirstLines = ant.IgnoreFirstLines;
                    mWizardInfo.ClassBuilder.IgnoreLastLines = ant.IgnoreLastLines;

                    mWizardInfo.ClassBuilder.Namespace = ant.Namespace;
                    mWizardInfo.ClassBuilder.SealedClass = ant.SealedClass;
                    mWizardInfo.ClassBuilder.Visibility = ant.Visibility;

                    foreach (FieldBuilder f in ant.Fields)
                    {
                        mWizardInfo.FixedLengthBuilder.AddField(f.FieldName, (int)txtFieldLength.Value, f.FieldType);
                        mWizardInfo.FixedLengthBuilder.LastField.FieldOptional = f.FieldOptional;
                        mWizardInfo.FixedLengthBuilder.LastField.FieldNotInFile = f.FieldNotInFile;
                        mWizardInfo.FixedLengthBuilder.LastField.FieldInNewLine = f.FieldInNewLine;
                        mWizardInfo.FixedLengthBuilder.LastField.FieldNullValue = f.FieldNullValue;
                        mWizardInfo.FixedLengthBuilder.LastField.TrimChars = f.TrimChars;
                        mWizardInfo.FixedLengthBuilder.LastField.TrimMode = f.TrimMode;
                        mWizardInfo.FixedLengthBuilder.LastField.Visibility = f.Visibility;
                    }
                }

            }
            else
            {
                mControlType = typeof(FieldDelimitedControl);
                mFieldType = typeof(FixedFieldBuilder);

                txtFieldLength.Enabled = false;

                string delimiter = string.Empty;

                if (radDelCustom.Checked)
                    delimiter = txtDelimiter.Text;
                else if (radDelComma.Checked)
                    delimiter = ",";
                else if (radDelSemiCol.Checked)
                    delimiter = ";";
                else if (radDelTabs.Checked)
                    delimiter = "\t";
                else if (radDelVertBar.Checked)
                    delimiter = "|";

                if (ant is DelimitedClassBuilder)
                {
                    mWizardInfo.DelimitedBuilder.Delimiter = delimiter;
                    return true;
                }

                mWizardInfo.ClassBuilder = new DelimitedClassBuilder(txtClassName.Text, delimiter);
                if (ant != null)
                {
                    mWizardInfo.ClassBuilder.ClassName = ant.ClassName;
                    mWizardInfo.ClassBuilder.GenerateProperties = ant.GenerateProperties;
                    mWizardInfo.ClassBuilder.IgnoreEmptyLines = ant.IgnoreEmptyLines;
                    mWizardInfo.ClassBuilder.IgnoreFirstLines = ant.IgnoreFirstLines;
                    mWizardInfo.ClassBuilder.IgnoreLastLines = ant.IgnoreLastLines;

                    mWizardInfo.ClassBuilder.Namespace = ant.Namespace;
                    mWizardInfo.ClassBuilder.SealedClass = ant.SealedClass;
                    mWizardInfo.ClassBuilder.Visibility = ant.Visibility;

                    foreach (FieldBuilder f in ant.Fields)
                    {
                        mWizardInfo.DelimitedBuilder.AddField(f.FieldName, f.FieldType);
                        mWizardInfo.DelimitedBuilder.LastField.FieldOptional = f.FieldOptional;
                        mWizardInfo.DelimitedBuilder.LastField.FieldNotInFile = f.FieldNotInFile;
                        mWizardInfo.DelimitedBuilder.LastField.FieldInNewLine = f.FieldInNewLine;
                        mWizardInfo.DelimitedBuilder.LastField.FieldNullValue = f.FieldNullValue;
                        mWizardInfo.DelimitedBuilder.LastField.TrimChars = f.TrimChars;
                        mWizardInfo.DelimitedBuilder.LastField.TrimMode = f.TrimMode;
                        mWizardInfo.DelimitedBuilder.LastField.Visibility = f.Visibility;
                    }
                }

            }


            cboFieldVisibility.DataSource = Enum.GetValues(typeof(NetVisibility));
            cboFieldVisibility.SelectedItem = mWizardInfo.FieldVisibility;

            // cboClassVisibility.DataSource = Enum.GetValues(typeof(NetVisibility));
            cboClassVisibility.SelectedItem = mWizardInfo.ClassBuilder.Visibility;

            return true;
        }

        #endregion

        #region "  ProcessStep1  "

        private bool ProcessStep1()
        {
            mWizardInfo.DefaultType = txtDefaultType.Text;

            if (mWizardInfo.ClassBuilder.FieldCount == 0)
            {
                
                for (int i = 0; i < txtNumberOfFields.Value; i++)
                {
                    FieldBuilder field;
                    
                    if (mWizardInfo.ClassBuilder is DelimitedClassBuilder)
                        field = mWizardInfo.DelimitedBuilder.AddField("Field" + (mWizardInfo.ClassBuilder.FieldCount + 1).ToString(), mWizardInfo.DefaultType);
                    else
                        field = mWizardInfo.FixedLengthBuilder.AddField("Field" + (mWizardInfo.ClassBuilder.FieldCount + 1).ToString(), (int) txtFieldLength.Value, mWizardInfo.DefaultType);

                    field.Visibility = (NetVisibility)Enum.Parse(typeof(NetVisibility), cboFieldVisibility.Text);

                }
               
                txtNumberOfFields.Enabled = false;
                txtDefaultType.Enabled = false;
                txtFieldLength.Enabled = false;

            }

            panFields.SuspendLayout();
            panFields.Controls.Clear();

            foreach (FieldBuilder info in mWizardInfo.ClassBuilder.Fields)
            {
                panFields.Controls.Add(CreateFieldControlFromInfo(info));
            }

            panFields.ResumeLayout();

            cmdPreview.Enabled = true;

            panFields.Focus();

            chkAllQuoted.Visible = mWizardInfo.ClassBuilder is DelimitedClassBuilder;

            ExpandAndShowPreview();
            return true;
        }

        //private FieldBuilder CreateFieldInfo()
        //{
        //    FieldBuilder info = (FieldBuilder)mFieldType.InvokeMember("new", System.Reflection.BindingFlags.CreateInstance, null, null, 
        //            new object[] {});

        //    info.Visibility = (NetVisibility)Enum.Parse(typeof(NetVisibility), cboFieldVisibility.Text);

        //    return info;
        //}

        private FieldBaseControl CreateFieldControl()
        {
            FieldBuilder field;

            if (mWizardInfo.ClassBuilder is DelimitedClassBuilder)
                field = mWizardInfo.DelimitedBuilder.AddField("Field" + (mWizardInfo.ClassBuilder.FieldCount + 1).ToString(), mWizardInfo.DefaultType);
            else
                field = mWizardInfo.FixedLengthBuilder.AddField("Field" + (mWizardInfo.ClassBuilder.FieldCount + 1).ToString(), (int) txtFieldLength.Value, mWizardInfo.DefaultType);

            field.Visibility = (NetVisibility)Enum.Parse(typeof(NetVisibility), cboFieldVisibility.Text);

            return CreateFieldControlFromInfo(field);
        }

        private FieldBaseControl CreateFieldControlFromInfo(FieldBuilder info)
        {
            FieldBaseControl ctrl = (FieldBaseControl)mControlType.InvokeMember("new", System.Reflection.BindingFlags.CreateInstance, null, null, null);
            ctrl.FieldInfo = info;

            ctrl.FieldInfoReload();
            ctrl.InfoChanged += new EventHandler(FieldControlChange);
            ctrl.OrderChanged += new EventHandler(FieldControlOrderChange);

            return ctrl;
        }


        #endregion

        #region "  ProcessStep2  "

        private bool ProcessStep2()
        {
            cboLanguage.SelectedIndex = 0;

            ReloadTemplates();
            return true;
        }

        private void ReloadTemplates()
        {
            mLoading = true;

            string languagePrefix;

            switch (mWizardInfo.Language)
            {
                case NetLanguage.CSharp:
                    languagePrefix = "CS -";
                    break;

                case NetLanguage.VbNet:
                    languagePrefix = "VB -";
                    break;

                default:
                    languagePrefix = "";
                    break;
            }

            DirectoryInfo di = new DirectoryInfo(Path.GetDirectoryName(Application.ExecutablePath) + @"\Templates");

            cboTemplate.Items.Clear();
            foreach (var file in di.GetFiles(languagePrefix + "*.tpl"))
            {
                cboTemplate.Items.Add(new TemplateInfo(file.FullName));
            }

            mLoading = false;

            if (cboTemplate.Items.Count > 0)
            {
                cboTemplate.SelectedIndex = 0;
            }
        }

        #endregion

        void FieldControlChange(object sender, EventArgs e)
        {
            ExpandAndShowPreview();
        }

        void FieldControlOrderChange(object sender, EventArgs e)
        {
            // CLEAR: JEJEJ
            // mWizardInfo.LoadFields(panFields.Controls);
            ReloadFields();
            ExpandAndShowPreview();
        }

        private void ReloadFields()
        {
            mWizardInfo.ClassBuilder.ClearFields();

            foreach (FieldBaseControl ctrl in panFields.Controls)
            {
                if (mWizardInfo.DelimitedBuilder != null)
                    mWizardInfo.DelimitedBuilder.AddField((DelimitedFieldBuilder) ctrl.FieldInfo);
                else
                    mWizardInfo.FixedLengthBuilder.AddField((FixedFieldBuilder) ctrl.FieldInfo);

                ctrl.RePaintData();
            }
        }

        private void cmdBack_Click(object sender, EventArgs e)
        {

            if (panStep1.Visible)
            {
                panStep0.Show();
                lblStep0.ForeColor = Color.White;

                picCurrStep.Top -= 25;

                panStep1.Hide();
                lblStep1.ForeColor = Color.DarkGray;

                txtClassName.Focus();
                cmdBack.Enabled = false;
            }
            else if (panStep2.Visible)
            {
                panStep1.Show();
                lblStep1.ForeColor = Color.White;

                picCurrStep.Top -= 25;

                panStep2.Hide();
                lblStep2.ForeColor = Color.DarkGray;

                txtDefaultType.Focus();
            }
            else if (panStep3.Visible)
            {
                panStep2.Show();
                lblStep2.ForeColor = Color.White;

                picCurrStep.Top -= 25;

                panStep3.Hide();
                lblStep3.ForeColor = Color.DarkGray;

                if (panFields.Controls.Count > 0)
                    panFields.Controls[0].Focus();

                cmdNext.Enabled = true;
            }

        }


        bool mExpanded = false;
        private void cmdPreview_Click(object sender, EventArgs e)
        {

            if (mExpanded)
            {
//                panPreview.Anchor = AnchorStyles.Top | AnchorStyles.Left;
                this.Width = panStep1.Right - 1;
                mExpanded = false;
                cmdPreview.Text = "&Preview >>";
            }
            else
            {
                ExpandAndShowPreview();
            }
        }

        private void ExpandAndShowPreview()
        {
            if (mExpanded == false)
            {
                this.Width = Math.Min(900, Screen.PrimaryScreen.WorkingArea.Width - 40);
                if (Left + Width > Screen.PrimaryScreen.WorkingArea.Width)
                    this.Left = 30;

                mExpanded = true;
                cmdPreview.Text = "<< &Preview";
                if (cboClassLanguage.SelectedIndex == -1)
                    cboClassLanguage.SelectedIndex = 0;

                panPreview.Anchor = AnchorStyles.Right | AnchorStyles.Top | AnchorStyles.Left;
            }

            ReLoadPreview();
        }

        private void ReLoadPreview()
        {
            if (mLoadingFile != false)
                return;

            cboLanguage.SelectedItem = cboClassLanguage.SelectedItem;
            NetLanguageList.LanguageType selected = cboClassLanguage.SelectedItem as NetLanguageList.LanguageType;
            string output = mWizardInfo.WizardOutput(selected.Language);

            ShowCode(output, selected.Language);
        }

        private string mLastCode;
        private void ShowCode(string code, NetLanguage language)
        {
            mLastCode = code;
            var colorizer = new CodeColorizer();
            switch (language)
            {
                case NetLanguage.CSharp:
                    browserCode.DocumentText =  GetDefaultCss() + colorizer.Colorize(code, Languages.CSharp);
                    break;
                case NetLanguage.VbNet:
                    browserCode.DocumentText =  GetDefaultCss() + colorizer.Colorize(code, Languages.VbDotNet);
                    break;
                default:
                    throw new ArgumentOutOfRangeException("language");
            }

        }

        private string mLastTemplateCode;
        private void ShowTemplate(string code, NetLanguage language)
        {
            mLastTemplateCode = code;
            var colorizer = new CodeColorizer();
            switch (language)
            {
                case NetLanguage.CSharp:
                    browserTemplate.DocumentText =  GetDefaultCss() + colorizer.Colorize(code, Languages.CSharp);
                    break;
                case NetLanguage.VbNet:
                    browserTemplate.DocumentText =  GetDefaultCss() + colorizer.Colorize(code, Languages.VbDotNet);
                    break;
                default:
                    throw new ArgumentOutOfRangeException("language");
            }

        }


        private string GetDefaultCss()
        {
            return
                @"
<style type=""text/css"">
pre {
/*background-color: #EEF3F9;
border: 1px dashed grey;*/
font-family: Consolas,""Courier New"",Courier,Monospace !important;
font-size: 12px !important;
margin-top: 0;
padding: 6px 6px 6px 6px;
/*height: auto;
overflow: auto;
width: 100% !important;*/
}
</style>
";
        }


        private void radDelimited_CheckedChanged(object sender, EventArgs e)
        {

            gbxDelimitedBy.Enabled = radDelimited.Checked;
        }

        bool mLoading = true;

        bool mLoadingFile = false;

        private void cboTemplate_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cboTemplate.SelectedItem != null)
                ShowTemplate((TemplateInfo)cboTemplate.SelectedItem);
        }

        private void ShowTemplate(TemplateInfo templ)
        {
            if (templ == null)
                ShowTemplate("", (cboLanguage.SelectedItem as NetLanguageList.LanguageType).Language);
            else
            {
                string res = templ.TemplateBody;
                if( mWizardInfo.ClassBuilder != null )
                    res = res.Replace("${ClassName}", mWizardInfo.ClassBuilder.ClassName);

                ShowTemplate(res, (cboLanguage.SelectedItem as NetLanguageList.LanguageType).Language);
            }

        }

        private void cboLanguage_SelectedIndexChanged(object sender, EventArgs e)
        {
            NetLanguageList.LanguageType selected = cboLanguage.SelectedItem as NetLanguageList.LanguageType;

            mWizardInfo.Language = selected.Language;
            cboClassLanguage.SelectedItem = selected;

            ReloadTemplates();
        }

        private void cmdToClipboard_Click(object sender, EventArgs e)
        {
            Clipboard.SetText(mLastTemplateCode);
        }

        private void cmdSaveToFile_Click(object sender, EventArgs e)
        {
            try
            {
                if (RegConfig.HasValue("WizardTemplatePath"))
                    dlgSaveToFile.InitialDirectory = RegConfig.GetStringValue("WizardTemplatePath", "");
            }
            catch
            {}

            dlgSaveToFile.FilterIndex = cboLanguage.SelectedIndex + 1;
            dlgSaveToFile.FileName = "TemplateOur";

            if (dlgSaveToFile.ShowDialog() == DialogResult.OK)
            {
                File.WriteAllText(dlgSaveToFile.FileName, mLastTemplateCode);
                RegConfig.SetStringValue("WizardTemplatePath", Path.GetDirectoryName(dlgSaveToFile.FileName));
            }

        }

        private void cmdCopyClass_Click(object sender, EventArgs e)
        {
            Clipboard.SetText(mLastCode);
        }

        private void cmdSaveClass_Click(object sender, EventArgs e)
        {
            try
            {
                if (RegConfig.HasValue("WizardClassDir"))
                    dlgSaveToFile.InitialDirectory = RegConfig.GetStringValue("WizardClassDir", "");
            }
            catch 
            {}

            //  1 for C#,  2 for vb.
            dlgSaveToFile.FilterIndex = cboClassLanguage.SelectedIndex + 1;
            dlgSaveToFile.FileName = txtClassName.Text;

            if (dlgSaveToFile.ShowDialog() == DialogResult.OK)
            {
                File.WriteAllText(dlgSaveToFile.FileName, mLastCode);
                RegConfig.SetStringValue("WizardClassDir", Path.GetDirectoryName(dlgSaveToFile.FileName));
            }
        }

        private void cboClassLanguage_SelectedIndexChanged(object sender, EventArgs e)
        {
            ReLoadPreview();
        }

        private void cmdAddField_Click(object sender, EventArgs e)
        {
            FieldBaseControl ctrl = CreateFieldControl();

            //CLEAR:dsds
            //mWizardInfo.Fields.Add(ctrl.FieldInfo);
            panFields.Controls.Add(ctrl);

            ctrl.chkOptional.Checked = chkAllOptional.Checked;
            
            if (chkAllTrim.Checked)
                ctrl.cboTrim.SelectedIndex = 3;

            if (chkAllQuoted.Visible)
                ((FieldDelimitedControl) ctrl).txtQuoted.Text = "\"";
            
            ctrl.RePaintData();
            ReLoadPreview();
            
        }

        private void cmdSave_Click(object sender, EventArgs e)
        {
            dlgOpenWizard.FileName = "";

            try
            {
                if (RegConfig.HasValue("WizardOpenDir"))
                    dlgSaveWizard.InitialDirectory = RegConfig.GetStringValue("WizardOpenDir", "");
            }
            catch
            { }

            dlgSaveWizard.FileName = txtClassName.Text;
            if (dlgSaveWizard.ShowDialog() == DialogResult.OK)
            {
                RegConfig.SetStringValue("WizardOpenDir", Path.GetDirectoryName(dlgSaveWizard.FileName));
                mWizardInfo.ClassBuilder.SaveToXml(dlgSaveWizard.FileName);
            }
        }

        private void LoadFile(string pFileName)
        {
            string extension = System.IO.Path.GetExtension(pFileName);
            ClassBuilder builder;
            switch (extension.ToLower())
            {
                case "cs":
                    builder = ClassBuilder.LoadFromXml(pFileName);
                    break;

                case "xml":
                case "whs":
                    builder = ClassBuilder.LoadFromXml(pFileName);
                    break;

                default:
                    return;
            }
            ClassBuilderToWizard(builder);
        }

        private void cmdLoad_Click(object sender, EventArgs e)
        {
            dlgOpenWizard.FileName = "";

            try
            {
                if (RegConfig.HasValue("WizardOpenDir"))
                    dlgOpenWizard.InitialDirectory = RegConfig.GetStringValue("WizardOpenDir", "");
            }
            catch 
            {}

            if (dlgOpenWizard.ShowDialog() == DialogResult.OK)
            {
                RegConfig.SetStringValue("WizardOpenDir", Path.GetDirectoryName(dlgOpenWizard.FileName));

                mLoadingFile = true;
                Application.DoEvents();
                cmdSave.Enabled = true;

                ClassBuilder builder = ClassBuilder.LoadFromXml(dlgOpenWizard.FileName);
                ClassBuilderToWizard(builder);
            }

        }



        private void ClassBuilderToWizard(ClassBuilder builder)
        {
            mWizardInfo.ClassBuilder = builder;

            Application.DoEvents();

            WizardToControls();

            Application.DoEvents();

            if (mWizardInfo.ClassBuilder is FixedLengthClassBuilder)
            {
                radFixed.Checked = true;
                mControlType = typeof(FieldFixedControl);
                mFieldType = typeof(FixedFieldBuilder);

                txtFieldLength.Enabled = true;

            }
            else
            {
                txtFieldLength.Enabled = false;

                radDelimited.Checked = true;

                mControlType = typeof(FieldDelimitedControl);
                mFieldType = typeof(DelimitedFieldBuilder);

                txtDelimiter.Text = "";
                string delimiter = mWizardInfo.DelimitedBuilder.Delimiter;

                if (delimiter == "|")
                    radDelVertBar.Checked = true;
                else if (delimiter  == ",")
                    radDelComma.Checked = true;
                else if (delimiter == ";")
                    radDelSemiCol.Checked = true;
                else if (delimiter == "\t")
                    radDelTabs.Checked = true;
                else
                {
                    radDelCustom.Checked = true;
                    txtDelimiter.Text = delimiter;
                }
            }


            panFields.SuspendLayout();
            panFields.Controls.Clear();

            foreach (FieldBuilder info in mWizardInfo.ClassBuilder.Fields)
            {
                panFields.Controls.Add(CreateFieldControlFromInfo(info));
            }

            panFields.ResumeLayout();

            cmdPreview.Enabled = true;

            panFields.Focus();

            mLoadingFile = false;


            ExpandAndShowPreview();
        }

        private void WizardToControls()
        {

            txtClassName.Text = mWizardInfo.ClassBuilder.ClassName;

            txtDefaultType.Text = mWizardInfo.DefaultType;
            txtNumberOfFields.Value = mWizardInfo.ClassBuilder.FieldCount;

            txtDefaultType.Enabled = false;
            txtNumberOfFields.Enabled = false;

            txtIgnoreFirst.Value = mWizardInfo.ClassBuilder.IgnoreFirstLines;
            txtIgnoreLast.Value = mWizardInfo.ClassBuilder.IgnoreLastLines;
            chkIgnoreEmpty.Checked = mWizardInfo.ClassBuilder.IgnoreEmptyLines;
            
            cboFieldVisibility.SelectedItem = mWizardInfo.FieldVisibility;
            cboClassVisibility.SelectedItem = mWizardInfo.ClassBuilder.Visibility;
            cboRecordCondition.SelectedItem = mWizardInfo.ClassBuilder.RecordCondition.Condition;
            txtRecordConditionSelector.Text = mWizardInfo.ClassBuilder.RecordCondition.Selector;

            chkSealed.Checked = mWizardInfo.ClassBuilder.SealedClass;
            chkProperties.Checked = mWizardInfo.ClassBuilder.GenerateProperties;

            txtCommentMarker.Text = mWizardInfo.ClassBuilder.IgnoreCommentedLines.CommentMarker;
            chkCommentAnyPlace.Checked = mWizardInfo.ClassBuilder.IgnoreCommentedLines.InAnyPlace;

        }

        private void cboFieldVisibility_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (mMoving == false)
            {
                mWizardInfo.FieldVisibility = (NetVisibility)Enum.Parse(typeof(NetVisibility), cboFieldVisibility.Text);
                if (mWizardInfo.ClassBuilder.FieldCount > 0)
                    foreach (FieldBuilder info in mWizardInfo.ClassBuilder.Fields)
                        info.Visibility = mWizardInfo.FieldVisibility;

                ReLoadPreview();
            }
        }

        private void txtClassName_TextChanged(object sender, EventArgs e)
        {
            if  (mWizardInfo.ClassBuilder != null)
            {
				mWizardInfo.ClassBuilder.ClassName = txtClassName.Text;
				ReLoadPreview();
            }
        }

        private void cboClassVisibility_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (mMoving == false && mWizardInfo.ClassBuilder != null)
            {
                mWizardInfo.ClassBuilder.Visibility = (NetVisibility)cboClassVisibility.SelectedItem;
                ReLoadPreview();
            }

        }

        private void chkSealed_CheckedChanged(object sender, EventArgs e)
        {
            if (mWizardInfo.ClassBuilder != null)
            {
                mWizardInfo.ClassBuilder.SealedClass = chkSealed.Checked;
                ReLoadPreview();
            }
        }

        private void txtIgnoreFirst_ValueChanged(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder.IgnoreFirstLines = (int)txtIgnoreFirst.Value;
            ReLoadPreview();
        }

        private void txtIgnoreLast_ValueChanged(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder.IgnoreLastLines = (int)txtIgnoreLast.Value;
            ReLoadPreview();
        }

        private void chkProperties_CheckedChanged(object sender, EventArgs e)
        {
            if (mWizardInfo.ClassBuilder == null)
                return;

            mWizardInfo.ClassBuilder.GenerateProperties = chkProperties.Checked;
            ReLoadPreview();
        }

        private void chkIgnoreEmpty_CheckedChanged(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder.IgnoreEmptyLines = chkIgnoreEmpty.Checked;
            ReLoadPreview();
        }

        private void cmdTestClass_Click(object sender, EventArgs e)
        {
            using (var frm = new frmDataPreview(mLastCode, mWizardInfo.Language))
            {
                frm.ShowDialog();
                frm.Dispose();
            }
        }


        
        private void picDonate_Click(object sender, EventArgs e)
        {
            frmDonate frm = new frmDonate();
            frm.ShowDialog();
            frm.Dispose();
        }

        private void linkHome_Click(object sender, EventArgs e)
        {
            ProcessStartInfo info = new ProcessStartInfo("\"http://www.filehelpers.com\"");
            info.CreateNoWindow = false;
            info.UseShellExecute = true;
            Process.Start(info);
        }

        private void frmWizard_Activated(object sender, EventArgs e)
        {
            if (mFirstTime == false)
                return;

            mFirstTime = false;

            System.Threading.ThreadPool.QueueUserWorkItem(
                delegate(object targ)
                {
                    try
                    {
                        string ver = typeof(FileHelperEngine).Assembly.GetName().Version.ToString(3);
                        VersionData verLast;
                        verLast = VersionData.GetLastVersion();

                        if (VersionData.CompararVersiones(ver, verLast.Version) >= 0)
                            picCurrent.Invoke((MethodInvoker)delegate() { picCurrent.Visible = true; });
                        else
                        {
                            picCurrent.Invoke((MethodInvoker)delegate() {
                                picNewVersion.Visible = true;
                                picNewVersion.Tag = verLast;
                                toolTip1.SetToolTip(picNewVersion, "Version: " + verLast.Version + Environment.NewLine + verLast.Description);
                            });
                        }
                    }
                    catch
                    { }
                }
            );
        }
        


        private void radFixed_CheckedChanged(object sender, EventArgs e)
        {
            cboFixedMode2.Enabled = radFixed.Checked;
        }

        private void cboFixedMode2_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (mWizardInfo.FixedLengthBuilder != null)
            {
                mWizardInfo.FixedLengthBuilder.FixedMode = (FixedMode)cboFixedMode2.SelectedItem;
                ReLoadPreview();
            }
        }

        private void picNewVersion_Click(object sender, EventArgs e)
        {
            frmLastVersion frm = new frmLastVersion((VersionData)picNewVersion.Tag);
            frm.ShowDialog();
            frm.Dispose();
        }

        private void txtCommentMarker_TextChanged(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder.IgnoreCommentedLines.CommentMarker = txtCommentMarker.Text;
            ReLoadPreview();
        }

        private void chkCommentAnyPlace_CheckedChanged(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder.IgnoreCommentedLines.InAnyPlace = chkCommentAnyPlace.Checked;
            ReLoadPreview();
        }

        private void txtRecordConditionSelector_TextChanged(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder.RecordCondition.Selector = txtRecordConditionSelector.Text;
            ReLoadPreview();
        }

        private void cboRecordCondition_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (mWizardInfo.ClassBuilder != null)
            {
                mWizardInfo.ClassBuilder.RecordCondition.Condition = (RecordCondition)Enum.Parse(typeof(RecordCondition), cboRecordCondition.Text);
                ReLoadPreview();
            }
        }

       
        private void cmdReset_Click(object sender, EventArgs e)
        {
            mWizardInfo.ClassBuilder = null;
            panStep0.BringToFront();
            txtClassName.Text = "YourRecordClass";
            txtClassName.SelectAll();
            txtClassName.Focus();

            panStep0.Show();
            lblStep0.ForeColor = Color.White;

            picCurrStep.Top = picFirstDark.Top;
            panStep1.Hide();
            lblStep1.ForeColor = Color.DarkGray;
            panStep2.Hide();
            lblStep2.ForeColor = Color.DarkGray;
            panStep3.Hide();
            lblStep3.ForeColor = Color.DarkGray;

            cmdBack.Enabled = false;
            cmdNext.Enabled = true;

            txtNumberOfFields.Enabled = true;
            txtDefaultType.Enabled = true;
            cboFieldVisibility.Enabled = true;
            txtFieldLength.Enabled = true;
            cmdSave.Enabled = false;

            this.Width = panStep1.Right - 1;
            mExpanded = false;
            cmdPreview.Text = "&Preview >>";
            cmdPreview.Enabled = false;

            ShowCode("", NetLanguage.CSharp);
        }

        private void chkAllOptional_CheckedChanged(object sender, EventArgs e)
        {
            mLoadingFile = true;
            bool first = true;
            foreach (FieldBaseControl ctrl in panFields.Controls)
            {
                if (first)
                    first = false;
                else
                    ctrl.chkOptional.Checked = chkAllOptional.Checked;
            }

            mLoadingFile = false;
            ReLoadPreview();
        }

        private void chkAllQuoted_CheckedChanged(object sender, EventArgs e)
        {
            if (mWizardInfo.ClassBuilder is FixedLengthClassBuilder)
                return;

            mLoadingFile = true;
            foreach (FieldDelimitedControl ctrl in panFields.Controls)
            {
                if (chkAllQuoted.Checked)
                    ctrl.txtQuoted.Text = "\"";
                else
                    ctrl.txtQuoted.Text = "";
            }
            mLoadingFile = false;
            ReLoadPreview();
        }

        private void chkAllTrim_CheckedChanged(object sender, EventArgs e)
        {
            mLoadingFile = true;
            foreach (FieldBaseControl ctrl in panFields.Controls)
            {
                if (chkAllTrim.Checked)
                    ctrl.cboTrim.SelectedIndex = 3;
                else
                    ctrl.cboTrim.SelectedIndex = 0;

             //   ctrl.cboTrim.Refresh();
            }
            mLoadingFile = false;
            ReLoadPreview();

        }
       
        private void cmdfileDesigner_Click(object sender, EventArgs e)
        {
            frmDataFile frm = new frmDataFile();
            frm.ShowDialog();
            frm.Dispose();

        }

        private void cmdDetectFormat_Click(object sender, EventArgs e)
        {
            AutoDetectFormat(false);
        }

      

        private void cmdDetectFormatWithHeader_Click(object sender, EventArgs e)
        {
            AutoDetectFormat(true);
        }


        private void AutoDetectFormat(bool hasHeaders)
        {
            var dialog = new OpenFileDialog();
            dialog.Multiselect = false;
            dialog.Title = "Select a Sample File";
            if (dialog.ShowDialog() == DialogResult.Cancel)
                return;

            var detector = new SmartFormatDetector();
            detector.FileHasHeaders = hasHeaders;
            detector.MaxSampleLines = 100;
            var formats = detector.DetectFileFormat(dialog.FileName);

            if (formats.Length == 0)
                return;

            ClassBuilderToWizard(formats[0].ClassBuilder);

            var frm = new frmDataPreview(mLastCode, mWizardInfo.Language);
            frm.HasHeaders = hasHeaders;
            frm.txtInput.Text = File.ReadAllText(dialog.FileName);
            frm.AutoRunTest = true;
            frm.ShowDialog();
            frm.Dispose();
        }
    }
}
